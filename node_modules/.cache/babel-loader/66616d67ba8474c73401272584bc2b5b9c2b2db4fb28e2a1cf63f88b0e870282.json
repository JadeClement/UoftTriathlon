{"ast":null,"code":"import _objectSpread from\"/Users/jadeclement/Documents/Developer/uofttri/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{useAuth}from'../context/AuthContext';import'./WorkoutDetail.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const WorkoutDetail=()=>{const{id}=useParams();const navigate=useNavigate();const{currentUser,isMember}=useAuth();const[workout,setWorkout]=useState(null);const[signups,setSignups]=useState([]);const[waitlist,setWaitlist]=useState([]);const[comments,setComments]=useState([]);const[newComment,setNewComment]=useState('');const[loading,setLoading]=useState(true);const[isSignedUp,setIsSignedUp]=useState(false);const[isOnWaitlist,setIsOnWaitlist]=useState(false);const[showCancelModal,setShowCancelModal]=useState(false);const[attendance,setAttendance]=useState({});const[attendanceSaved,setAttendanceSaved]=useState(false);// Helpers for waitlist position display\nconst getWaitlistPosition=()=>{const idx=waitlist.findIndex(w=>w.user_name===currentUser.name);return idx===-1?null:idx+1;};const formatOrdinal=n=>{if(n==null)return'';const s=[\"th\",\"st\",\"nd\",\"rd\"],v=n%100;return n+(s[(v-20)%10]||s[v]||s[0]);};const API_BASE_URL='http://localhost:5001/api';useEffect(()=>{if(!currentUser){navigate('/login');return;}if(!isMember(currentUser)){navigate('/login');return;}loadWorkoutDetails();},[currentUser,navigate,isMember,id]);const loadWorkoutDetails=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}// Load workout details\nconst workoutResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id),{headers:{'Authorization':\"Bearer \".concat(token)}});if(workoutResponse.ok){const workoutData=await workoutResponse.json();setWorkout(workoutData.workout);}// Load signups\nconst signupsResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signups\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(signupsResponse.ok){const signupsData=await signupsResponse.json();console.log('📋 Signups data received:',signupsData);console.log('👥 Individual signups:',signupsData.signups);setSignups(signupsData.signups);// Check if current user is signed up\nconst userSignup=signupsData.signups.find(s=>s.user_name===currentUser.name);setIsSignedUp(!!userSignup);}// Load waitlist\nconst waitlistResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(waitlistResponse.ok){const waitlistData=await waitlistResponse.json();setWaitlist(waitlistData.waitlist);// Check if current user is on waitlist\nconst userWaitlist=waitlistData.waitlist.find(w=>w.user_name===currentUser.name);setIsOnWaitlist(!!userWaitlist);}// Load comments (will be implemented with real backend data)\nsetComments([]);// Load attendance\nconst attendanceResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/attendance\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(attendanceResponse.ok){const attendanceData=await attendanceResponse.json();console.log('📊 Attendance data loaded:',attendanceData);setAttendance(attendanceData);// If there's existing attendance data, mark as saved\nif(Object.keys(attendanceData).length>0){setAttendanceSaved(true);console.log('✅ Attendance marked as saved');}else{console.log('📝 No attendance recorded yet - ready for submission');}}setLoading(false);}catch(error){console.error('Error loading workout details:',error);setLoading(false);}};const handleSignUp=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signup\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){const result=await response.json();if(result.signedUp){// User just signed up\nsetIsSignedUp(true);// Reload signups to get the updated list\nconst signupsResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signups\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(signupsResponse.ok){const signupsData=await signupsResponse.json();setSignups(signupsData.signups);}}else{// User just removed signup\nsetIsSignedUp(false);// Reload signups to get the updated list\nconst signupsResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signups\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(signupsResponse.ok){const signupsData=await signupsResponse.json();setSignups(signupsData.signups);}}}else{const error=await response.json();alert(\"Error: \".concat(error.error));}}catch(error){console.error('Error updating signup:',error);alert('Error updating signup');}};const handleWaitlistJoin=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){setIsOnWaitlist(true);// Reload waitlist\nconst waitlistResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(waitlistResponse.ok){const waitlistData=await waitlistResponse.json();setWaitlist(waitlistData.waitlist);}}else{const error=await response.json();alert(\"Error: \".concat(error.error));}}catch(error){console.error('Error joining waitlist:',error);alert('Error joining waitlist');}};const handleWaitlistLeave=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{method:'DELETE',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){setIsOnWaitlist(false);// Reload waitlist\nconst waitlistResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(waitlistResponse.ok){const waitlistData=await response.json();setWaitlist(waitlistData.waitlist);}}else{const error=await response.json();alert(\"Error: \".concat(error.error));}}catch(error){console.error('Error leaving waitlist:',error);alert('Error leaving waitlist');}};const handleCancelClick=()=>{setShowCancelModal(true);};const handleCancelSignup=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signup\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){setIsSignedUp(false);// Reload signups\nconst signupsResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signups\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(signupsResponse.ok){const signupsData=await signupsResponse.json();setSignups(signupsData.signups);}// Reload waitlist to check for promotions\nconst waitlistResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(waitlistResponse.ok){const waitlistData=await waitlistResponse.json();setWaitlist(waitlistData.waitlist);}setShowCancelModal(false);}else{const error=await response.json();alert(\"Error: \".concat(error.error));}}catch(error){console.error('Error canceling signup:',error);alert('Error canceling signup');}};const closeCancelModal=()=>{setShowCancelModal(false);};const handleAttendanceChange=(userId,isPresent)=>{console.log('📝 Attendance change:',{userId,isPresent,type:typeof userId});if(!userId){console.error('❌ Invalid user ID:',userId);return;}setAttendance(prev=>_objectSpread(_objectSpread({},prev),{},{[userId]:isPresent}));};const handleSubmitAttendance=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/attendance\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify({attendanceData:attendance})});if(response.ok){const result=await response.json();console.log('Attendance saved successfully:',result.message);setAttendanceSaved(true);// Mark attendance as saved\n// Show success message\nalert('Attendance submitted successfully! This cannot be modified.');}else{const errorData=await response.json();console.error('Failed to save attendance:',errorData.error);alert(\"Failed to save attendance: \".concat(errorData.error));}}catch(error){console.error('Error submitting attendance:',error);alert('Error submitting attendance. Please try again.');}};const handleCommentSubmit=async e=>{e.preventDefault();if(!newComment.trim())return;try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const newCommentObj={id:Date.now(),user_name:currentUser.name,content:newComment.trim(),created_at:new Date().toISOString()};setComments([...comments,newCommentObj]);setNewComment('');}catch(error){console.error('Error adding comment:',error);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading workout details...\"});}if(!workout){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:\"Workout not found\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"workout-detail-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-btn\",onClick:()=>navigate('/forum'),children:\"\\u2190 Back to Forum\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"workout-detail-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"workout-header\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"workout-title\",children:workout.title}),/*#__PURE__*/_jsx(\"div\",{className:\"workout-author\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"author-info\",children:[workout.authorProfilePictureUrl?/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:5001\".concat(workout.authorProfilePictureUrl),alt:\"Profile\",className:\"author-avatar\"}):/*#__PURE__*/_jsx(\"div\",{className:\"author-avatar-placeholder\",children:/*#__PURE__*/_jsx(\"span\",{children:workout.author_name?workout.author_name.charAt(0).toUpperCase():'U'})}),/*#__PURE__*/_jsxs(\"span\",{className:\"author-name\",children:[\"Posted by \",workout.author_name]})]})})]}),workout.workout_type&&/*#__PURE__*/_jsxs(\"div\",{className:\"workout-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"workout-type-badge\",children:workout.workout_type}),workout.workout_date&&/*#__PURE__*/_jsxs(\"span\",{className:\"workout-date\",children:[\"\\uD83D\\uDCC5 \",new Date(workout.workout_date).toLocaleDateString(),workout.workout_time&&/*#__PURE__*/_jsxs(\"span\",{className:\"workout-time\",children:[\" \\u2022 \\uD83D\\uDD50 \",workout.workout_time]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"workout-content\",children:workout.content}),/*#__PURE__*/_jsx(\"div\",{className:\"workout-actions\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"button-group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSignUp,className:\"signup-btn \".concat(isSignedUp?'signed-up':''),disabled:workout.capacity&&signups.length>=workout.capacity&&!isSignedUp,children:isSignedUp?'✓ Signed Up':workout.capacity&&signups.length>=workout.capacity?'Full':'Sign Up'}),isSignedUp&&/*#__PURE__*/_jsx(\"button\",{onClick:handleCancelClick,className:\"cancel-btn\",children:\"Cancel\"}),workout.capacity&&signups.length>=workout.capacity&&!isSignedUp&&/*#__PURE__*/_jsx(\"button\",{onClick:isOnWaitlist?handleWaitlistLeave:handleWaitlistJoin,className:\"waitlist-btn \".concat(isOnWaitlist?'on-waitlist':''),children:isOnWaitlist?'Leave Waitlist':'Join Waitlist'}),workout.capacity&&signups.length>=workout.capacity&&isOnWaitlist&&/*#__PURE__*/_jsx(\"span\",{className:\"waitlist-position\",children:\"You're \".concat(formatOrdinal(getWaitlistPosition()),\" on the waitlist\")})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"signups-section\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Who's Coming (\",signups.length,workout.capacity?\"/\".concat(workout.capacity):'',\")\"]}),signups.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-signups\",children:\"No one has signed up yet. Be the first!\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"signups-list\",children:signups.map(signup=>/*#__PURE__*/_jsxs(\"div\",{className:\"signup-item\",children:[currentUser&&(currentUser.role==='exec'||currentUser.role==='administrator')&&/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-checkbox\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"attendance-\".concat(signup.user_id),checked:attendance[signup.user_id]||false,onChange:e=>{console.log('🔍 Checkbox change for signup:',signup);handleAttendanceChange(signup.user_id,e.target.checked);},disabled:attendanceSaved,title:attendanceSaved?\"Attendance already submitted - cannot modify\":\"Mark as present\"}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"attendance-\".concat(signup.user_id),className:\"sr-only\",children:[\"Mark \",signup.user_name,\" as present\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"signup-user-info\",children:[signup.userProfilePictureUrl?/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:5001\".concat(signup.userProfilePictureUrl),alt:\"Profile\",className:\"user-avatar\"}):/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar-placeholder\",children:/*#__PURE__*/_jsx(\"span\",{children:signup.user_name?signup.user_name.charAt(0).toUpperCase():'U'})}),/*#__PURE__*/_jsx(\"span\",{className:\"signup-user\",children:signup.user_name})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"signup-date\",children:[\"\\uD83D\\uDCC5 \",new Date(signup.signed_up_at).toLocaleDateString(),/*#__PURE__*/_jsxs(\"span\",{className:\"signup-time\",children:[\" \\u2022 \\uD83D\\uDD50 \",new Date(signup.signed_up_at).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})]})]})]},signup.id))}),currentUser&&(currentUser.role==='exec'||currentUser.role==='administrator')&&signups.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"attendance-submit\",children:attendanceSaved?/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-locked\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"locked-icon\",children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"span\",{className:\"locked-text\",children:\"Attendance Submitted - Cannot be Modified\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"attendance-debug\",children:/*#__PURE__*/_jsxs(\"small\",{children:[\"\\uD83D\\uDCCA \",signups.length,\" signups \\u2022 \",Object.keys(attendance).length,\" attendance records\"]})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmitAttendance,className:\"submit-attendance-btn\",title:\"Submit attendance and update absences (cannot be modified after submission)\",children:\"\\uD83D\\uDCDD Submit Attendance\"})]})})]})]}),workout.capacity&&waitlist.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"waitlist-section\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Waitlist (\",waitlist.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"waitlist-list\",children:waitlist.map(waitlistItem=>/*#__PURE__*/_jsxs(\"div\",{className:\"waitlist-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"waitlist-user-info\",children:[waitlistItem.userProfilePictureUrl?/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:5001\".concat(waitlistItem.userProfilePictureUrl),alt:\"Profile\",className:\"user-avatar\"}):/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar-placeholder\",children:/*#__PURE__*/_jsx(\"span\",{children:waitlistItem.user_name?waitlistItem.user_name.charAt(0).toUpperCase():'U'})}),/*#__PURE__*/_jsx(\"span\",{className:\"waitlist-user\",children:waitlistItem.user_name})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"waitlist-date\",children:[\"\\uD83D\\uDCC5 \",new Date(waitlistItem.joined_at).toLocaleDateString(),/*#__PURE__*/_jsxs(\"span\",{className:\"waitlist-time\",children:[\" \\u2022 \\uD83D\\uDD50 \",new Date(waitlistItem.joined_at).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})]})]})]},waitlistItem.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"comments-section\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Comments (\",comments.length,\")\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCommentSubmit,className:\"comment-form\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:newComment,onChange:e=>setNewComment(e.target.value),placeholder:\"Add a comment...\",rows:\"3\",maxLength:\"500\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"comment-submit-btn\",children:\"Post Comment\"})]}),comments.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-comments\",children:\"No comments yet. Start the conversation!\"}):/*#__PURE__*/_jsx(\"div\",{className:\"comments-list\",children:comments.map(comment=>/*#__PURE__*/_jsxs(\"div\",{className:\"comment-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-author-info\",children:[comment.userProfilePictureUrl?/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:5001\".concat(comment.userProfilePictureUrl),alt:\"Profile\",className:\"user-avatar\"}):/*#__PURE__*/_jsx(\"div\",{className:\"user-avatar-placeholder\",children:/*#__PURE__*/_jsx(\"span\",{children:comment.user_name?comment.user_name.charAt(0).toUpperCase():'U'})}),/*#__PURE__*/_jsx(\"span\",{className:\"comment-author\",children:comment.user_name})]}),/*#__PURE__*/_jsx(\"span\",{className:\"comment-date\",children:(()=>{try{const date=new Date(comment.created_at);if(isNaN(date.getTime())){return\"\\uD83D\\uDCC5 \".concat(comment.created_at);}return/*#__PURE__*/_jsxs(_Fragment,{children:[\"\\uD83D\\uDCC5 \",date.toLocaleDateString(),/*#__PURE__*/_jsxs(\"span\",{className:\"comment-time\",children:[\" \\u2022 \\uD83D\\uDD50 \",date.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})]})]});}catch(error){return\"\\uD83D\\uDCC5 \".concat(comment.created_at);}})()})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-content\",children:comment.content})]},comment.id))})]}),showCancelModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Cancel Workout Signup\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Are you sure you want to cancel your signup for this workout?\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"warning-text\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Warning:\"}),\" If you cancel less than 24 hours in advance, it will count as an absence. Your absences are recorded and once you have three, you will be suspended from signing up for a week. This is to keep it fair for all members!\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleCancelSignup,className:\"btn btn-danger\",children:\"Cancel Signup\"}),/*#__PURE__*/_jsx(\"button\",{onClick:closeCancelModal,className:\"btn btn-secondary\",children:\"Keep Booking\"})]})]})})]})});};export default WorkoutDetail;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","useAuth","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","WorkoutDetail","id","navigate","currentUser","isMember","workout","setWorkout","signups","setSignups","waitlist","setWaitlist","comments","setComments","newComment","setNewComment","loading","setLoading","isSignedUp","setIsSignedUp","isOnWaitlist","setIsOnWaitlist","showCancelModal","setShowCancelModal","attendance","setAttendance","attendanceSaved","setAttendanceSaved","getWaitlistPosition","idx","findIndex","w","user_name","name","formatOrdinal","n","s","v","API_BASE_URL","loadWorkoutDetails","token","localStorage","getItem","console","error","workoutResponse","fetch","concat","headers","ok","workoutData","json","signupsResponse","signupsData","log","userSignup","find","waitlistResponse","waitlistData","userWaitlist","attendanceResponse","attendanceData","Object","keys","length","handleSignUp","response","method","result","signedUp","alert","handleWaitlistJoin","handleWaitlistLeave","handleCancelClick","handleCancelSignup","closeCancelModal","handleAttendanceChange","userId","isPresent","type","prev","_objectSpread","handleSubmitAttendance","body","JSON","stringify","message","errorData","handleCommentSubmit","e","preventDefault","trim","newCommentObj","Date","now","content","created_at","toISOString","className","children","onClick","title","authorProfilePictureUrl","src","alt","author_name","charAt","toUpperCase","workout_type","workout_date","toLocaleDateString","workout_time","disabled","capacity","map","signup","role","user_id","checked","onChange","target","htmlFor","userProfilePictureUrl","signed_up_at","toLocaleTimeString","hour","minute","waitlistItem","joined_at","onSubmit","value","placeholder","rows","maxLength","required","comment","date","isNaN","getTime"],"sources":["/Users/jadeclement/Documents/Developer/uofttri/src/components/WorkoutDetail.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport './WorkoutDetail.css';\n\nconst WorkoutDetail = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const { currentUser, isMember } = useAuth();\n  const [workout, setWorkout] = useState(null);\n  const [signups, setSignups] = useState([]);\n  const [waitlist, setWaitlist] = useState([]);\n  const [comments, setComments] = useState([]);\n  const [newComment, setNewComment] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [isSignedUp, setIsSignedUp] = useState(false);\n  const [isOnWaitlist, setIsOnWaitlist] = useState(false);\n  const [showCancelModal, setShowCancelModal] = useState(false);\n  const [attendance, setAttendance] = useState({});\n  const [attendanceSaved, setAttendanceSaved] = useState(false);\n\n  // Helpers for waitlist position display\n  const getWaitlistPosition = () => {\n    const idx = waitlist.findIndex(w => w.user_name === currentUser.name);\n    return idx === -1 ? null : idx + 1;\n  };\n\n  const formatOrdinal = (n) => {\n    if (n == null) return '';\n    const s = [\"th\",\"st\",\"nd\",\"rd\"], v = n % 100;\n    return n + (s[(v-20)%10] || s[v] || s[0]);\n  };\n\n  const API_BASE_URL = 'http://localhost:5001/api';\n\n  useEffect(() => {\n    if (!currentUser) {\n      navigate('/login');\n      return;\n    }\n    \n    if (!isMember(currentUser)) {\n      navigate('/login');\n      return;\n    }\n    \n    loadWorkoutDetails();\n  }, [currentUser, navigate, isMember, id]);\n\n  const loadWorkoutDetails = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      // Load workout details\n      const workoutResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (workoutResponse.ok) {\n        const workoutData = await workoutResponse.json();\n        setWorkout(workoutData.workout);\n      }\n\n      // Load signups\n      const signupsResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signups`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (signupsResponse.ok) {\n        const signupsData = await signupsResponse.json();\n        console.log('📋 Signups data received:', signupsData);\n        console.log('👥 Individual signups:', signupsData.signups);\n        setSignups(signupsData.signups);\n        \n        // Check if current user is signed up\n        const userSignup = signupsData.signups.find(s => s.user_name === currentUser.name);\n        setIsSignedUp(!!userSignup);\n      }\n\n      // Load waitlist\n      const waitlistResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (waitlistResponse.ok) {\n        const waitlistData = await waitlistResponse.json();\n        setWaitlist(waitlistData.waitlist);\n        \n        // Check if current user is on waitlist\n        const userWaitlist = waitlistData.waitlist.find(w => w.user_name === currentUser.name);\n        setIsOnWaitlist(!!userWaitlist);\n      }\n\n      // Load comments (will be implemented with real backend data)\n      setComments([]);\n\n      // Load attendance\n      const attendanceResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/attendance`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (attendanceResponse.ok) {\n        const attendanceData = await attendanceResponse.json();\n        console.log('📊 Attendance data loaded:', attendanceData);\n        setAttendance(attendanceData);\n        // If there's existing attendance data, mark as saved\n        if (Object.keys(attendanceData).length > 0) {\n          setAttendanceSaved(true);\n          console.log('✅ Attendance marked as saved');\n        } else {\n          console.log('📝 No attendance recorded yet - ready for submission');\n        }\n      }\n\n      setLoading(false);\n    } catch (error) {\n      console.error('Error loading workout details:', error);\n      setLoading(false);\n    }\n  };\n\n  const handleSignUp = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signup`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        \n        if (result.signedUp) {\n          // User just signed up\n          setIsSignedUp(true);\n          // Reload signups to get the updated list\n          const signupsResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signups`, {\n            headers: {\n              'Authorization': `Bearer ${token}`\n            }\n          });\n          \n          if (signupsResponse.ok) {\n            const signupsData = await signupsResponse.json();\n            setSignups(signupsData.signups);\n          }\n        } else {\n          // User just removed signup\n          setIsSignedUp(false);\n          // Reload signups to get the updated list\n          const signupsResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signups`, {\n            headers: {\n              'Authorization': `Bearer ${token}`\n            }\n          });\n          \n          if (signupsResponse.ok) {\n            const signupsData = await signupsResponse.json();\n            setSignups(signupsData.signups);\n          }\n        }\n      } else {\n        const error = await response.json();\n        alert(`Error: ${error.error}`);\n      }\n    } catch (error) {\n      console.error('Error updating signup:', error);\n      alert('Error updating signup');\n    }\n  };\n\n  const handleWaitlistJoin = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        setIsOnWaitlist(true);\n        // Reload waitlist\n        const waitlistResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        \n        if (waitlistResponse.ok) {\n          const waitlistData = await waitlistResponse.json();\n          setWaitlist(waitlistData.waitlist);\n        }\n      } else {\n        const error = await response.json();\n        alert(`Error: ${error.error}`);\n      }\n    } catch (error) {\n      console.error('Error joining waitlist:', error);\n      alert('Error joining waitlist');\n    }\n  };\n\n  const handleWaitlistLeave = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        setIsOnWaitlist(false);\n        // Reload waitlist\n        const waitlistResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        \n        if (waitlistResponse.ok) {\n          const waitlistData = await response.json();\n          setWaitlist(waitlistData.waitlist);\n        }\n      } else {\n        const error = await response.json();\n        alert(`Error: ${error.error}`);\n      }\n    } catch (error) {\n      console.error('Error leaving waitlist:', error);\n      alert('Error leaving waitlist');\n    }\n  };\n\n  const handleCancelClick = () => {\n    setShowCancelModal(true);\n  };\n\n  const handleCancelSignup = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signup`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        setIsSignedUp(false);\n        // Reload signups\n        const signupsResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signups`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        \n        if (signupsResponse.ok) {\n          const signupsData = await signupsResponse.json();\n          setSignups(signupsData.signups);\n        }\n\n        // Reload waitlist to check for promotions\n        const waitlistResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        \n        if (waitlistResponse.ok) {\n          const waitlistData = await waitlistResponse.json();\n          setWaitlist(waitlistData.waitlist);\n        }\n\n        setShowCancelModal(false);\n      } else {\n        const error = await response.json();\n        alert(`Error: ${error.error}`);\n      }\n    } catch (error) {\n      console.error('Error canceling signup:', error);\n      alert('Error canceling signup');\n    }\n  };\n\n  const closeCancelModal = () => {\n    setShowCancelModal(false);\n  };\n\n  const handleAttendanceChange = (userId, isPresent) => {\n    console.log('📝 Attendance change:', { userId, isPresent, type: typeof userId });\n    if (!userId) {\n      console.error('❌ Invalid user ID:', userId);\n      return;\n    }\n    setAttendance(prev => ({\n      ...prev,\n      [userId]: isPresent\n    }));\n  };\n\n  const handleSubmitAttendance = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}/attendance`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          attendanceData: attendance\n        })\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        console.log('Attendance saved successfully:', result.message);\n        setAttendanceSaved(true); // Mark attendance as saved\n        // Show success message\n        alert('Attendance submitted successfully! This cannot be modified.');\n      } else {\n        const errorData = await response.json();\n        console.error('Failed to save attendance:', errorData.error);\n        alert(`Failed to save attendance: ${errorData.error}`);\n      }\n    } catch (error) {\n      console.error('Error submitting attendance:', error);\n      alert('Error submitting attendance. Please try again.');\n    }\n  };\n\n  const handleCommentSubmit = async (e) => {\n    e.preventDefault();\n    if (!newComment.trim()) return;\n\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const newCommentObj = {\n        id: Date.now(),\n        user_name: currentUser.name,\n        content: newComment.trim(),\n        created_at: new Date().toISOString()\n      };\n\n      setComments([...comments, newCommentObj]);\n      setNewComment('');\n    } catch (error) {\n      console.error('Error adding comment:', error);\n    }\n  };\n\n  if (loading) {\n    return <div className=\"loading\">Loading workout details...</div>;\n  }\n\n  if (!workout) {\n    return <div className=\"error\">Workout not found</div>;\n  }\n\n  return (\n    <div className=\"workout-detail-container\">\n      <div className=\"container\">\n        <button className=\"back-btn\" onClick={() => navigate('/forum')}>\n          ← Back to Forum\n        </button>\n\n        <div className=\"workout-detail-card\">\n          <div className=\"workout-header\">\n            <h1 className=\"workout-title\">{workout.title}</h1>\n            <div className=\"workout-author\">\n              <div className=\"author-info\">\n                {workout.authorProfilePictureUrl ? (\n                  <img \n                    src={`http://localhost:5001${workout.authorProfilePictureUrl}`} \n                    alt=\"Profile\" \n                    className=\"author-avatar\"\n                  />\n                ) : (\n                  <div className=\"author-avatar-placeholder\">\n                    <span>{workout.author_name ? workout.author_name.charAt(0).toUpperCase() : 'U'}</span>\n                  </div>\n                )}\n                <span className=\"author-name\">Posted by {workout.author_name}</span>\n              </div>\n            </div>\n          </div>\n\n          {workout.workout_type && (\n            <div className=\"workout-meta\">\n              <span className=\"workout-type-badge\">{workout.workout_type}</span>\n              {workout.workout_date && (\n                <span className=\"workout-date\">\n                  📅 {new Date(workout.workout_date).toLocaleDateString()}\n                  {workout.workout_time && (\n                    <span className=\"workout-time\"> • 🕐 {workout.workout_time}</span>\n                  )}\n                </span>\n              )}\n            </div>\n          )}\n\n          <div className=\"workout-content\">\n            {workout.content}\n          </div>\n\n          <div className=\"workout-actions\">\n            <div className=\"button-group\">\n              <button \n                onClick={handleSignUp}\n                className={`signup-btn ${isSignedUp ? 'signed-up' : ''}`}\n                disabled={workout.capacity && signups.length >= workout.capacity && !isSignedUp}\n              >\n                {isSignedUp ? '✓ Signed Up' : (workout.capacity && signups.length >= workout.capacity) ? 'Full' : 'Sign Up'}\n              </button>\n              \n              {/* Cancel button for signed-up users */}\n              {isSignedUp && (\n                <button \n                  onClick={handleCancelClick}\n                  className=\"cancel-btn\"\n                >\n                  Cancel\n                </button>\n              )}\n              \n              {/* Waitlist button for full workouts */}\n              {workout.capacity && signups.length >= workout.capacity && !isSignedUp && (\n                <button \n                  onClick={isOnWaitlist ? handleWaitlistLeave : handleWaitlistJoin}\n                  className={`waitlist-btn ${isOnWaitlist ? 'on-waitlist' : ''}`}\n                >\n                  {isOnWaitlist ? 'Leave Waitlist' : 'Join Waitlist'}\n                </button>\n              )}\n\n              {/* Position label when on waitlist */}\n              {workout.capacity && signups.length >= workout.capacity && isOnWaitlist && (\n                <span className=\"waitlist-position\">\n                  {`You're ${formatOrdinal(getWaitlistPosition())} on the waitlist`}\n                </span>\n              )}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"signups-section\">\n          <h2>Who's Coming ({signups.length}{workout.capacity ? `/${workout.capacity}` : ''})</h2>\n          {signups.length === 0 ? (\n            <p className=\"no-signups\">No one has signed up yet. Be the first!</p>\n          ) : (\n            <>\n              <div className=\"signups-list\">\n                {signups.map(signup => (\n                  <div key={signup.id} className=\"signup-item\">\n                    {/* Attendance checkbox for executives only */}\n                    {currentUser && (currentUser.role === 'exec' || currentUser.role === 'administrator') && (\n                      <div className=\"attendance-checkbox\">\n                        <input\n                          type=\"checkbox\"\n                          id={`attendance-${signup.user_id}`}\n                          checked={attendance[signup.user_id] || false}\n                          onChange={(e) => {\n                            console.log('🔍 Checkbox change for signup:', signup);\n                            handleAttendanceChange(signup.user_id, e.target.checked);\n                          }}\n                          disabled={attendanceSaved}\n                          title={attendanceSaved ? \"Attendance already submitted - cannot modify\" : \"Mark as present\"}\n                        />\n                        <label htmlFor={`attendance-${signup.user_id}`} className=\"sr-only\">\n                          Mark {signup.user_name} as present\n                        </label>\n                      </div>\n                    )}\n                    \n                    <div className=\"signup-user-info\">\n                      {signup.userProfilePictureUrl ? (\n                        <img \n                          src={`http://localhost:5001${signup.userProfilePictureUrl}`} \n                          alt=\"Profile\" \n                          className=\"user-avatar\"\n                        />\n                      ) : (\n                        <div className=\"user-avatar-placeholder\">\n                          <span>{signup.user_name ? signup.user_name.charAt(0).toUpperCase() : 'U'}</span>\n                        </div>\n                      )}\n                      <span className=\"signup-user\">{signup.user_name}</span>\n                    </div>\n                    <span className=\"signup-date\">\n                      📅 {new Date(signup.signed_up_at).toLocaleDateString()}\n                      <span className=\"signup-time\"> • 🕐 {new Date(signup.signed_up_at).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>\n                    </span>\n                  </div>\n                ))}\n              </div>\n              \n              {/* Submit attendance button for executives only */}\n              {currentUser && (currentUser.role === 'exec' || currentUser.role === 'administrator') && signups.length > 0 && (\n                <div className=\"attendance-submit\">\n                  {attendanceSaved ? (\n                    <div className=\"attendance-locked\">\n                      <span className=\"locked-icon\">🔒</span>\n                      <span className=\"locked-text\">Attendance Submitted - Cannot be Modified</span>\n                    </div>\n                  ) : (\n                    <>\n                      <div className=\"attendance-debug\">\n                        <small>📊 {signups.length} signups • {Object.keys(attendance).length} attendance records</small>\n                      </div>\n                      <button \n                        onClick={handleSubmitAttendance}\n                        className=\"submit-attendance-btn\"\n                        title=\"Submit attendance and update absences (cannot be modified after submission)\"\n                      >\n                        📝 Submit Attendance\n                      </button>\n                    </>\n                  )}\n                </div>\n              )}\n            </>\n          )}\n        </div>\n\n        {/* Waitlist section */}\n        {workout.capacity && waitlist.length > 0 && (\n          <div className=\"waitlist-section\">\n            <h2>Waitlist ({waitlist.length})</h2>\n            <div className=\"waitlist-list\">\n              {waitlist.map(waitlistItem => (\n                <div key={waitlistItem.id} className=\"waitlist-item\">\n                  <div className=\"waitlist-user-info\">\n                    {waitlistItem.userProfilePictureUrl ? (\n                      <img \n                        src={`http://localhost:5001${waitlistItem.userProfilePictureUrl}`} \n                        alt=\"Profile\" \n                        className=\"user-avatar\"\n                      />\n                    ) : (\n                      <div className=\"user-avatar-placeholder\">\n                        <span>{waitlistItem.user_name ? waitlistItem.user_name.charAt(0).toUpperCase() : 'U'}</span>\n                      </div>\n                    )}\n                    <span className=\"waitlist-user\">{waitlistItem.user_name}</span>\n                  </div>\n                  <span className=\"waitlist-date\">\n                    📅 {new Date(waitlistItem.joined_at).toLocaleDateString()}\n                    <span className=\"waitlist-time\"> • 🕐 {new Date(waitlistItem.joined_at).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>\n                  </span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        <div className=\"comments-section\">\n          <h2>Comments ({comments.length})</h2>\n          \n          <form onSubmit={handleCommentSubmit} className=\"comment-form\">\n            <textarea\n              value={newComment}\n              onChange={(e) => setNewComment(e.target.value)}\n              placeholder=\"Add a comment...\"\n              rows=\"3\"\n              maxLength=\"500\"\n              required\n            />\n            <button type=\"submit\" className=\"comment-submit-btn\">Post Comment</button>\n          </form>\n\n          {comments.length === 0 ? (\n            <p className=\"no-comments\">No comments yet. Start the conversation!</p>\n          ) : (\n            <div className=\"comments-list\">\n              {comments.map(comment => (\n                <div key={comment.id} className=\"comment-item\">\n                  <div className=\"comment-header\">\n                    <div className=\"comment-author-info\">\n                      {comment.userProfilePictureUrl ? (\n                        <img \n                          src={`http://localhost:5001${comment.userProfilePictureUrl}`} \n                          alt=\"Profile\" \n                          className=\"user-avatar\"\n                        />\n                      ) : (\n                        <div className=\"user-avatar-placeholder\">\n                          <span>{comment.user_name ? comment.user_name.charAt(0).toUpperCase() : 'U'}</span>\n                        </div>\n                      )}\n                      <span className=\"comment-author\">{comment.user_name}</span>\n                    </div>\n                    <span className=\"comment-date\">\n                      {(() => {\n                        try {\n                          const date = new Date(comment.created_at);\n                          if (isNaN(date.getTime())) {\n                            return `📅 ${comment.created_at}`;\n                          }\n                          return (\n                            <>\n                              📅 {date.toLocaleDateString()}\n                              <span className=\"comment-time\"> • 🕐 {date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>\n                            </>\n                          );\n                        } catch (error) {\n                          return `📅 ${comment.created_at}`;\n                        }\n                      })()}\n                    </span>\n                  </div>\n                  <div className=\"comment-content\">{comment.content}</div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Cancel Confirmation Modal */}\n        {showCancelModal && (\n          <div className=\"modal-overlay\">\n            <div className=\"modal\">\n              <h2>Cancel Workout Signup</h2>\n              <p>Are you sure you want to cancel your signup for this workout?</p>\n              <p className=\"warning-text\">\n                <strong>Warning:</strong> If you cancel less than 24 hours in advance, it will count as an absence. \n                Your absences are recorded and once you have three, you will be suspended from signing up for a week. \n                This is to keep it fair for all members!\n              </p>\n              <div className=\"modal-actions\">\n                <button onClick={handleCancelSignup} className=\"btn btn-danger\">Cancel Signup</button>\n                <button onClick={closeCancelModal} className=\"btn btn-secondary\">Keep Booking</button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default WorkoutDetail;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}