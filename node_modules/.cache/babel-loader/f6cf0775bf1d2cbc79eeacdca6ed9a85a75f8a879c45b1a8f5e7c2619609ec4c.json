{"ast":null,"code":"import _objectSpread from\"/Users/jadeclement/Documents/Developer/uofttri/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useParams,useNavigate}from'react-router-dom';import{useAuth}from'../context/AuthContext';import'./WorkoutDetail.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const WorkoutDetail=()=>{const{id}=useParams();const navigate=useNavigate();const{currentUser,isMember}=useAuth();const[workout,setWorkout]=useState(null);const[signups,setSignups]=useState([]);const[waitlist,setWaitlist]=useState([]);const[comments,setComments]=useState([]);const[newComment,setNewComment]=useState('');const[loading,setLoading]=useState(true);const[isSignedUp,setIsSignedUp]=useState(false);const[isOnWaitlist,setIsOnWaitlist]=useState(false);const[showCancelModal,setShowCancelModal]=useState(false);const[attendance,setAttendance]=useState({});const[attendanceSaved,setAttendanceSaved]=useState(false);const[editMode,setEditMode]=useState(false);const[editedTitle,setEditedTitle]=useState('');const[editedDate,setEditedDate]=useState('');const[editedTime,setEditedTime]=useState('');const[editedContent,setEditedContent]=useState('');const[saving,setSaving]=useState(false);// Helpers for waitlist position display\nconst getWaitlistPosition=()=>{const idx=waitlist.findIndex(w=>w.user_name===currentUser.name);return idx===-1?null:idx+1;};const formatOrdinal=n=>{if(n==null)return'';const s=[\"th\",\"st\",\"nd\",\"rd\"],v=n%100;return n+(s[(v-20)%10]||s[v]||s[0]);};const API_BASE_URL='http://localhost:5001/api';useEffect(()=>{if(!currentUser){navigate('/login');return;}if(!isMember(currentUser)){navigate('/login');return;}loadWorkoutDetails();},[currentUser,navigate,isMember,id]);const loadWorkoutDetails=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}// Load workout details\nconst workoutResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id),{headers:{'Authorization':\"Bearer \".concat(token)}});if(workoutResponse.ok){const workoutData=await workoutResponse.json();setWorkout(workoutData.workout);}// Load signups\nconst signupsResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signups\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(signupsResponse.ok){const signupsData=await signupsResponse.json();console.log('üìã Signups data received:',signupsData);console.log('üë• Individual signups:',signupsData.signups);setSignups(signupsData.signups);// Check if current user is signed up\nconst userSignup=signupsData.signups.find(s=>s.user_name===currentUser.name);setIsSignedUp(!!userSignup);}// Load waitlist\nconst waitlistResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(waitlistResponse.ok){const waitlistData=await waitlistResponse.json();setWaitlist(waitlistData.waitlist);// Check if current user is on waitlist\nconst userWaitlist=waitlistData.waitlist.find(w=>w.user_name===currentUser.name);setIsOnWaitlist(!!userWaitlist);}// Load comments (will be implemented with real backend data)\nsetComments([]);// Load attendance\nconst attendanceResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/attendance\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(attendanceResponse.ok){const attendanceData=await attendanceResponse.json();console.log('üìä Attendance data loaded:',attendanceData);setAttendance(attendanceData);// If there's existing attendance data, mark as saved\nif(Object.keys(attendanceData).length>0){setAttendanceSaved(true);console.log('‚úÖ Attendance marked as saved');}else{console.log('üìù No attendance recorded yet - ready for submission');}}setLoading(false);}catch(error){console.error('Error loading workout details:',error);setLoading(false);}};const handleSignUp=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signup\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){const result=await response.json();if(result.signedUp){// User just signed up\nsetIsSignedUp(true);// Reload signups to get the updated list\nconst signupsResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signups\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(signupsResponse.ok){const signupsData=await signupsResponse.json();setSignups(signupsData.signups);}}else{// User just removed signup\nsetIsSignedUp(false);// Reload signups to get the updated list\nconst signupsResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signups\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(signupsResponse.ok){const signupsData=await signupsResponse.json();setSignups(signupsData.signups);}}}else{const error=await response.json();alert(\"Error: \".concat(error.error));}}catch(error){console.error('Error updating signup:',error);alert('Error updating signup');}};const handleWaitlistJoin=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){setIsOnWaitlist(true);// Reload waitlist\nconst waitlistResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(waitlistResponse.ok){const waitlistData=await waitlistResponse.json();setWaitlist(waitlistData.waitlist);}}else{const error=await response.json();alert(\"Error: \".concat(error.error));}}catch(error){console.error('Error joining waitlist:',error);alert('Error joining waitlist');}};const handleWaitlistLeave=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{method:'DELETE',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){setIsOnWaitlist(false);// Reload waitlist\nconst waitlistResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(waitlistResponse.ok){const waitlistData=await response.json();setWaitlist(waitlistData.waitlist);}}else{const error=await response.json();alert(\"Error: \".concat(error.error));}}catch(error){console.error('Error leaving waitlist:',error);alert('Error leaving waitlist');}};const handleCancelClick=()=>{setShowCancelModal(true);};const handleEditWorkout=()=>{setEditedTitle(workout.title);setEditedDate(workout.workout_date?workout.workout_date.split('T')[0]:'');setEditedTime(workout.workout_time||'');setEditedContent(workout.content);setEditMode(true);};const handleCancelEdit=()=>{setEditMode(false);setEditedTitle('');setEditedDate('');setEditedTime('');setEditedContent('');};const handleSaveWorkout=async()=>{setSaving(true);try{const token=localStorage.getItem('triathlonToken');if(!token){throw new Error('No authentication token found');}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id),{method:'PUT',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify({title:editedTitle,workout_date:editedDate,workout_time:editedTime,content:editedContent})});if(response.ok){const updatedWorkout=await response.json();setWorkout(updatedWorkout.workout);setEditMode(false);setSaving(false);alert('Workout updated successfully!');}else{const error=await response.json();throw new Error(error.error||'Failed to update workout');}}catch(error){console.error('Error updating workout:',error);alert(\"Error updating workout: \".concat(error.message));setSaving(false);}};const handleDeleteWorkout=async()=>{if(!window.confirm('Are you sure you want to delete this workout post?')){return;}try{const token=localStorage.getItem('triathlonToken');if(!token){throw new Error('No authentication token found');}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id),{method:'DELETE',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){navigate('/forum');}else{const error=await response.json();throw new Error(error.error||'Failed to delete workout');}}catch(error){console.error('Error deleting workout:',error);alert(\"Error deleting workout: \".concat(error.message));}};const handleCancelSignup=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signup\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){setIsSignedUp(false);// Reload signups\nconst signupsResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/signups\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(signupsResponse.ok){const signupsData=await signupsResponse.json();setSignups(signupsData.signups);}// Reload waitlist to check for promotions\nconst waitlistResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/waitlist\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(waitlistResponse.ok){const waitlistData=await waitlistResponse.json();setWaitlist(waitlistData.waitlist);}setShowCancelModal(false);}else{const error=await response.json();alert(\"Error: \".concat(error.error));}}catch(error){console.error('Error canceling signup:',error);alert('Error canceling signup');}};const closeCancelModal=()=>{setShowCancelModal(false);};const handleAttendanceChange=(userId,isPresent)=>{console.log('üìù Attendance change:',{userId,isPresent,type:typeof userId});if(!userId){console.error('‚ùå Invalid user ID:',userId);return;}setAttendance(prev=>_objectSpread(_objectSpread({},prev),{},{[userId]:isPresent}));};const handleSubmitAttendance=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(id,\"/attendance\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify({attendanceData:attendance})});if(response.ok){const result=await response.json();console.log('Attendance saved successfully:',result.message);setAttendanceSaved(true);// Mark attendance as saved\n// Show success message\nalert('Attendance submitted successfully! This cannot be modified.');}else{const errorData=await response.json();console.error('Failed to save attendance:',errorData.error);alert(\"Failed to save attendance: \".concat(errorData.error));}}catch(error){console.error('Error submitting attendance:',error);alert('Error submitting attendance. Please try again.');}};const handleCommentSubmit=async e=>{e.preventDefault();if(!newComment.trim())return;try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const newCommentObj={id:Date.now(),user_name:currentUser.name,content:newComment.trim(),created_at:new Date().toISOString()};setComments([...comments,newCommentObj]);setNewComment('');}catch(error){console.error('Error adding comment:',error);}};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading workout details...\"});}if(!workout){return/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:\"Workout not found\"});}return/*#__PURE__*/_jsx(\"div\",{className:\"workout-detail-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"back-btn\",onClick:()=>navigate('/forum'),children:\"\\u2190 Back to Forum\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"workout-detail-card\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"workout-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"workout-title-section\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"workout-title\",children:workout.title}),(()=>{const canEdit=currentUser.id===workout.user_id||currentUser.role==='exec'||currentUser.role==='administrator';console.log('üîç Edit button permission check:',{currentUserId:currentUser.id,workoutUserId:workout.user_id,currentUserRole:currentUser.role,isAuthor:currentUser.id===workout.user_id,isExec:currentUser.role==='exec',isAdmin:currentUser.role==='administrator',canEdit:canEdit});return canEdit;})()&&/*#__PURE__*/_jsxs(\"div\",{className:\"workout-actions-admin\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"edit-btn\",onClick:handleEditWorkout,disabled:editMode,children:\"\\u270F\\uFE0F Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"delete-btn\",onClick:handleDeleteWorkout,disabled:editMode,children:\"\\uD83D\\uDDD1\\uFE0F Delete\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"workout-author\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"author-info\",children:[workout.authorProfilePictureUrl?/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:5001\".concat(workout.authorProfilePictureUrl),alt:\"Profile\",className:\"author-avatar\",onError:e=>{e.target.src='/images/default_profile.png';}}):/*#__PURE__*/_jsx(\"img\",{src:\"/images/default_profile.png\",alt:\"Profile\",className:\"author-avatar\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"author-name\",children:[\"Posted by \",workout.author_name]})]})})]}),workout.workout_type&&/*#__PURE__*/_jsxs(\"div\",{className:\"workout-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"workout-type-badge\",children:workout.workout_type}),workout.workout_date&&/*#__PURE__*/_jsxs(\"span\",{className:\"workout-date\",children:[\"\\uD83D\\uDCC5 \",new Date(workout.workout_date).toLocaleDateString(),workout.workout_time&&/*#__PURE__*/_jsxs(\"span\",{className:\"workout-time\",children:[\" \\u2022 \\uD83D\\uDD50 \",workout.workout_time]})]})]}),editMode?/*#__PURE__*/_jsxs(\"div\",{className:\"workout-edit-form\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"workout-title-input\",children:\"Title:\"}),/*#__PURE__*/_jsx(\"input\",{id:\"workout-title-input\",type:\"text\",value:editedTitle,onChange:e=>setEditedTitle(e.target.value),className:\"form-input\",placeholder:\"Enter workout title...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"workout-date-input\",children:\"Date:\"}),/*#__PURE__*/_jsx(\"input\",{id:\"workout-date-input\",type:\"date\",value:editedDate,onChange:e=>setEditedDate(e.target.value),className:\"form-input\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"workout-time-input\",children:\"Time:\"}),/*#__PURE__*/_jsx(\"input\",{id:\"workout-time-input\",type:\"time\",value:editedTime,onChange:e=>setEditedTime(e.target.value),className:\"form-input\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"workout-content-input\",children:\"Description:\"}),/*#__PURE__*/_jsx(\"textarea\",{id:\"workout-content-input\",value:editedContent,onChange:e=>setEditedContent(e.target.value),className:\"form-textarea\",rows:\"5\",placeholder:\"Enter workout description...\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"edit-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary\",onClick:handleSaveWorkout,disabled:saving,children:saving?'Saving...':'Save Changes'}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-secondary\",onClick:handleCancelEdit,disabled:saving,children:\"Cancel\"})]})]}):/*#__PURE__*/_jsx(\"div\",{className:\"workout-content\",children:workout.content}),/*#__PURE__*/_jsx(\"div\",{className:\"workout-actions\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"button-group\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleSignUp,className:\"signup-btn \".concat(isSignedUp?'signed-up':''),disabled:workout.capacity&&signups.length>=workout.capacity&&!isSignedUp,children:isSignedUp?'‚úì Signed Up':workout.capacity&&signups.length>=workout.capacity?'Full':'Sign Up'}),isSignedUp&&/*#__PURE__*/_jsx(\"button\",{onClick:handleCancelClick,className:\"cancel-btn\",children:\"Cancel\"}),workout.capacity&&signups.length>=workout.capacity&&!isSignedUp&&/*#__PURE__*/_jsx(\"button\",{onClick:isOnWaitlist?handleWaitlistLeave:handleWaitlistJoin,className:\"waitlist-btn \".concat(isOnWaitlist?'on-waitlist':''),children:isOnWaitlist?'Leave Waitlist':'Join Waitlist'}),workout.capacity&&signups.length>=workout.capacity&&isOnWaitlist&&/*#__PURE__*/_jsx(\"span\",{className:\"waitlist-position\",children:\"You're \".concat(formatOrdinal(getWaitlistPosition()),\" on the waitlist\")})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"signups-section\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Who's Coming (\",signups.length,workout.capacity?\"/\".concat(workout.capacity):'',\")\"]}),signups.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-signups\",children:\"No one has signed up yet. Be the first!\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"signups-list\",children:signups.map(signup=>/*#__PURE__*/_jsxs(\"div\",{className:\"signup-item\",children:[currentUser&&(currentUser.role==='exec'||currentUser.role==='administrator')&&/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-checkbox\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"attendance-\".concat(signup.user_id),checked:attendance[signup.user_id]||false,onChange:e=>{console.log('üîç Checkbox change for signup:',signup);handleAttendanceChange(signup.user_id,e.target.checked);},disabled:attendanceSaved,title:attendanceSaved?\"Attendance already submitted - cannot modify\":\"Mark as present\"}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"attendance-\".concat(signup.user_id),className:\"sr-only\",children:[\"Mark \",signup.user_name,\" as present\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"signup-user-info\",children:[signup.userProfilePictureUrl?/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:5001\".concat(signup.userProfilePictureUrl),alt:\"Profile\",className:\"user-avatar\",onError:e=>{e.target.src='/images/default_profile.png';}}):/*#__PURE__*/_jsx(\"img\",{src:\"/images/default_profile.png\",alt:\"Profile\",className:\"user-avatar\"}),/*#__PURE__*/_jsx(\"span\",{className:\"signup-user\",children:signup.user_name})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"signup-date\",children:[\"\\uD83D\\uDCC5 \",new Date(signup.signed_up_at).toLocaleDateString(),/*#__PURE__*/_jsxs(\"span\",{className:\"signup-time\",children:[\" \\u2022 \\uD83D\\uDD50 \",new Date(signup.signed_up_at).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})]})]})]},signup.id))}),currentUser&&(currentUser.role==='exec'||currentUser.role==='administrator')&&signups.length>0&&/*#__PURE__*/_jsx(\"div\",{className:\"attendance-submit\",children:attendanceSaved?/*#__PURE__*/_jsxs(\"div\",{className:\"attendance-locked\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"locked-icon\",children:\"\\uD83D\\uDD12\"}),/*#__PURE__*/_jsx(\"span\",{className:\"locked-text\",children:\"Attendance Submitted - Cannot be Modified\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"attendance-debug\",children:/*#__PURE__*/_jsxs(\"small\",{children:[\"\\uD83D\\uDCCA \",signups.length,\" signups \\u2022 \",Object.keys(attendance).length,\" attendance records\"]})}),/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmitAttendance,className:\"submit-attendance-btn\",title:\"Submit attendance and update absences (cannot be modified after submission)\",children:\"\\uD83D\\uDCDD Submit Attendance\"})]})})]})]}),workout.capacity&&waitlist.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"waitlist-section\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Waitlist (\",waitlist.length,\")\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"waitlist-list\",children:waitlist.map(waitlistItem=>/*#__PURE__*/_jsxs(\"div\",{className:\"waitlist-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"waitlist-user-info\",children:[waitlistItem.userProfilePictureUrl?/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:5001\".concat(waitlistItem.userProfilePictureUrl),alt:\"Profile\",className:\"user-avatar\",onError:e=>{e.target.src='/images/default_profile.png';}}):/*#__PURE__*/_jsx(\"img\",{src:\"/images/default_profile.png\",alt:\"Profile\",className:\"user-avatar\"}),/*#__PURE__*/_jsx(\"span\",{className:\"waitlist-user\",children:waitlistItem.user_name})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"waitlist-date\",children:[\"\\uD83D\\uDCC5 \",new Date(waitlistItem.joined_at).toLocaleDateString(),/*#__PURE__*/_jsxs(\"span\",{className:\"waitlist-time\",children:[\" \\u2022 \\uD83D\\uDD50 \",new Date(waitlistItem.joined_at).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})]})]})]},waitlistItem.id))})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"comments-section\",children:[/*#__PURE__*/_jsxs(\"h2\",{children:[\"Comments (\",comments.length,\")\"]}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleCommentSubmit,className:\"comment-form\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:newComment,onChange:e=>setNewComment(e.target.value),placeholder:\"Add a comment...\",rows:\"3\",maxLength:\"500\",required:true}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"comment-submit-btn\",children:\"Post Comment\"})]}),comments.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-comments\",children:\"No comments yet. Start the conversation!\"}):/*#__PURE__*/_jsx(\"div\",{className:\"comments-list\",children:comments.map(comment=>/*#__PURE__*/_jsxs(\"div\",{className:\"comment-item\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-author-info\",children:[comment.userProfilePictureUrl?/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:5001\".concat(comment.userProfilePictureUrl),alt:\"Profile\",className:\"user-avatar\",onError:e=>{e.target.src='/images/default_profile.png';}}):/*#__PURE__*/_jsx(\"img\",{src:\"/images/default_profile.png\",alt:\"Profile\",className:\"user-avatar\"}),/*#__PURE__*/_jsx(\"span\",{className:\"comment-author\",children:comment.user_name})]}),/*#__PURE__*/_jsx(\"span\",{className:\"comment-date\",children:(()=>{try{const date=new Date(comment.created_at);if(isNaN(date.getTime())){return\"\\uD83D\\uDCC5 \".concat(comment.created_at);}return/*#__PURE__*/_jsxs(_Fragment,{children:[\"\\uD83D\\uDCC5 \",date.toLocaleDateString(),/*#__PURE__*/_jsxs(\"span\",{className:\"comment-time\",children:[\" \\u2022 \\uD83D\\uDD50 \",date.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})]})]});}catch(error){return\"\\uD83D\\uDCC5 \".concat(comment.created_at);}})()})]}),/*#__PURE__*/_jsx(\"div\",{className:\"comment-content\",children:comment.content})]},comment.id))})]}),showCancelModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Cancel Workout Signup\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Are you sure you want to cancel your signup for this workout?\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"warning-text\",children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Warning:\"}),\" If you cancel less than 24 hours in advance, it will count as an absence. Your absences are recorded and once you have three, you will be suspended from signing up for a week. This is to keep it fair for all members!\"]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleCancelSignup,className:\"btn btn-danger\",children:\"Cancel Signup\"}),/*#__PURE__*/_jsx(\"button\",{onClick:closeCancelModal,className:\"btn btn-secondary\",children:\"Keep Booking\"})]})]})})]})});};export default WorkoutDetail;","map":{"version":3,"names":["React","useState","useEffect","useParams","useNavigate","useAuth","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","WorkoutDetail","id","navigate","currentUser","isMember","workout","setWorkout","signups","setSignups","waitlist","setWaitlist","comments","setComments","newComment","setNewComment","loading","setLoading","isSignedUp","setIsSignedUp","isOnWaitlist","setIsOnWaitlist","showCancelModal","setShowCancelModal","attendance","setAttendance","attendanceSaved","setAttendanceSaved","editMode","setEditMode","editedTitle","setEditedTitle","editedDate","setEditedDate","editedTime","setEditedTime","editedContent","setEditedContent","saving","setSaving","getWaitlistPosition","idx","findIndex","w","user_name","name","formatOrdinal","n","s","v","API_BASE_URL","loadWorkoutDetails","token","localStorage","getItem","console","error","workoutResponse","fetch","concat","headers","ok","workoutData","json","signupsResponse","signupsData","log","userSignup","find","waitlistResponse","waitlistData","userWaitlist","attendanceResponse","attendanceData","Object","keys","length","handleSignUp","response","method","result","signedUp","alert","handleWaitlistJoin","handleWaitlistLeave","handleCancelClick","handleEditWorkout","title","workout_date","split","workout_time","content","handleCancelEdit","handleSaveWorkout","Error","body","JSON","stringify","updatedWorkout","message","handleDeleteWorkout","window","confirm","handleCancelSignup","closeCancelModal","handleAttendanceChange","userId","isPresent","type","prev","_objectSpread","handleSubmitAttendance","errorData","handleCommentSubmit","e","preventDefault","trim","newCommentObj","Date","now","created_at","toISOString","className","children","onClick","canEdit","user_id","role","currentUserId","workoutUserId","currentUserRole","isAuthor","isExec","isAdmin","disabled","authorProfilePictureUrl","src","alt","onError","target","author_name","workout_type","toLocaleDateString","htmlFor","value","onChange","placeholder","rows","capacity","map","signup","checked","userProfilePictureUrl","signed_up_at","toLocaleTimeString","hour","minute","waitlistItem","joined_at","onSubmit","maxLength","required","comment","date","isNaN","getTime"],"sources":["/Users/jadeclement/Documents/Developer/uofttri/src/components/WorkoutDetail.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport { useAuth } from '../context/AuthContext';\nimport './WorkoutDetail.css';\n\nconst WorkoutDetail = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const { currentUser, isMember } = useAuth();\n  const [workout, setWorkout] = useState(null);\n  const [signups, setSignups] = useState([]);\n  const [waitlist, setWaitlist] = useState([]);\n  const [comments, setComments] = useState([]);\n  const [newComment, setNewComment] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [isSignedUp, setIsSignedUp] = useState(false);\n  const [isOnWaitlist, setIsOnWaitlist] = useState(false);\n  const [showCancelModal, setShowCancelModal] = useState(false);\n  const [attendance, setAttendance] = useState({});\n  const [attendanceSaved, setAttendanceSaved] = useState(false);\n  const [editMode, setEditMode] = useState(false);\n  const [editedTitle, setEditedTitle] = useState('');\n  const [editedDate, setEditedDate] = useState('');\n  const [editedTime, setEditedTime] = useState('');\n  const [editedContent, setEditedContent] = useState('');\n  const [saving, setSaving] = useState(false);\n\n  // Helpers for waitlist position display\n  const getWaitlistPosition = () => {\n    const idx = waitlist.findIndex(w => w.user_name === currentUser.name);\n    return idx === -1 ? null : idx + 1;\n  };\n\n  const formatOrdinal = (n) => {\n    if (n == null) return '';\n    const s = [\"th\",\"st\",\"nd\",\"rd\"], v = n % 100;\n    return n + (s[(v-20)%10] || s[v] || s[0]);\n  };\n\n  const API_BASE_URL = 'http://localhost:5001/api';\n\n  useEffect(() => {\n    if (!currentUser) {\n      navigate('/login');\n      return;\n    }\n    \n    if (!isMember(currentUser)) {\n      navigate('/login');\n      return;\n    }\n    \n    loadWorkoutDetails();\n  }, [currentUser, navigate, isMember, id]);\n\n  const loadWorkoutDetails = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      // Load workout details\n      const workoutResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (workoutResponse.ok) {\n        const workoutData = await workoutResponse.json();\n        setWorkout(workoutData.workout);\n      }\n\n      // Load signups\n      const signupsResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signups`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (signupsResponse.ok) {\n        const signupsData = await signupsResponse.json();\n        console.log('üìã Signups data received:', signupsData);\n        console.log('üë• Individual signups:', signupsData.signups);\n        setSignups(signupsData.signups);\n        \n        // Check if current user is signed up\n        const userSignup = signupsData.signups.find(s => s.user_name === currentUser.name);\n        setIsSignedUp(!!userSignup);\n      }\n\n      // Load waitlist\n      const waitlistResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (waitlistResponse.ok) {\n        const waitlistData = await waitlistResponse.json();\n        setWaitlist(waitlistData.waitlist);\n        \n        // Check if current user is on waitlist\n        const userWaitlist = waitlistData.waitlist.find(w => w.user_name === currentUser.name);\n        setIsOnWaitlist(!!userWaitlist);\n      }\n\n      // Load comments (will be implemented with real backend data)\n      setComments([]);\n\n      // Load attendance\n      const attendanceResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/attendance`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (attendanceResponse.ok) {\n        const attendanceData = await attendanceResponse.json();\n        console.log('üìä Attendance data loaded:', attendanceData);\n        setAttendance(attendanceData);\n        // If there's existing attendance data, mark as saved\n        if (Object.keys(attendanceData).length > 0) {\n          setAttendanceSaved(true);\n          console.log('‚úÖ Attendance marked as saved');\n        } else {\n          console.log('üìù No attendance recorded yet - ready for submission');\n        }\n      }\n\n      setLoading(false);\n    } catch (error) {\n      console.error('Error loading workout details:', error);\n      setLoading(false);\n    }\n  };\n\n  const handleSignUp = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signup`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        \n        if (result.signedUp) {\n          // User just signed up\n          setIsSignedUp(true);\n          // Reload signups to get the updated list\n          const signupsResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signups`, {\n            headers: {\n              'Authorization': `Bearer ${token}`\n            }\n          });\n          \n          if (signupsResponse.ok) {\n            const signupsData = await signupsResponse.json();\n            setSignups(signupsData.signups);\n          }\n        } else {\n          // User just removed signup\n          setIsSignedUp(false);\n          // Reload signups to get the updated list\n          const signupsResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signups`, {\n            headers: {\n              'Authorization': `Bearer ${token}`\n            }\n          });\n          \n          if (signupsResponse.ok) {\n            const signupsData = await signupsResponse.json();\n            setSignups(signupsData.signups);\n          }\n        }\n      } else {\n        const error = await response.json();\n        alert(`Error: ${error.error}`);\n      }\n    } catch (error) {\n      console.error('Error updating signup:', error);\n      alert('Error updating signup');\n    }\n  };\n\n  const handleWaitlistJoin = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        setIsOnWaitlist(true);\n        // Reload waitlist\n        const waitlistResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        \n        if (waitlistResponse.ok) {\n          const waitlistData = await waitlistResponse.json();\n          setWaitlist(waitlistData.waitlist);\n        }\n      } else {\n        const error = await response.json();\n        alert(`Error: ${error.error}`);\n      }\n    } catch (error) {\n      console.error('Error joining waitlist:', error);\n      alert('Error joining waitlist');\n    }\n  };\n\n  const handleWaitlistLeave = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        setIsOnWaitlist(false);\n        // Reload waitlist\n        const waitlistResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        \n        if (waitlistResponse.ok) {\n          const waitlistData = await response.json();\n          setWaitlist(waitlistData.waitlist);\n        }\n      } else {\n        const error = await response.json();\n        alert(`Error: ${error.error}`);\n      }\n    } catch (error) {\n      console.error('Error leaving waitlist:', error);\n      alert('Error leaving waitlist');\n    }\n  };\n\n  const handleCancelClick = () => {\n    setShowCancelModal(true);\n  };\n\n  const handleEditWorkout = () => {\n    setEditedTitle(workout.title);\n    setEditedDate(workout.workout_date ? workout.workout_date.split('T')[0] : '');\n    setEditedTime(workout.workout_time || '');\n    setEditedContent(workout.content);\n    setEditMode(true);\n  };\n\n  const handleCancelEdit = () => {\n    setEditMode(false);\n    setEditedTitle('');\n    setEditedDate('');\n    setEditedTime('');\n    setEditedContent('');\n  };\n\n  const handleSaveWorkout = async () => {\n    setSaving(true);\n    \n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        throw new Error('No authentication token found');\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}`, {\n        method: 'PUT',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          title: editedTitle,\n          workout_date: editedDate,\n          workout_time: editedTime,\n          content: editedContent\n        })\n      });\n\n      if (response.ok) {\n        const updatedWorkout = await response.json();\n        setWorkout(updatedWorkout.workout);\n        setEditMode(false);\n        setSaving(false);\n        alert('Workout updated successfully!');\n      } else {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to update workout');\n      }\n    } catch (error) {\n      console.error('Error updating workout:', error);\n      alert(`Error updating workout: ${error.message}`);\n      setSaving(false);\n    }\n  };\n\n  const handleDeleteWorkout = async () => {\n    if (!window.confirm('Are you sure you want to delete this workout post?')) {\n      return;\n    }\n\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        throw new Error('No authentication token found');\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        navigate('/forum');\n      } else {\n        const error = await response.json();\n        throw new Error(error.error || 'Failed to delete workout');\n      }\n    } catch (error) {\n      console.error('Error deleting workout:', error);\n      alert(`Error deleting workout: ${error.message}`);\n    }\n  };\n\n  const handleCancelSignup = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signup`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        setIsSignedUp(false);\n        // Reload signups\n        const signupsResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/signups`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        \n        if (signupsResponse.ok) {\n          const signupsData = await signupsResponse.json();\n          setSignups(signupsData.signups);\n        }\n\n        // Reload waitlist to check for promotions\n        const waitlistResponse = await fetch(`${API_BASE_URL}/forum/workouts/${id}/waitlist`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        \n        if (waitlistResponse.ok) {\n          const waitlistData = await waitlistResponse.json();\n          setWaitlist(waitlistData.waitlist);\n        }\n\n        setShowCancelModal(false);\n      } else {\n        const error = await response.json();\n        alert(`Error: ${error.error}`);\n      }\n    } catch (error) {\n      console.error('Error canceling signup:', error);\n      alert('Error canceling signup');\n    }\n  };\n\n  const closeCancelModal = () => {\n    setShowCancelModal(false);\n  };\n\n  const handleAttendanceChange = (userId, isPresent) => {\n    console.log('üìù Attendance change:', { userId, isPresent, type: typeof userId });\n    if (!userId) {\n      console.error('‚ùå Invalid user ID:', userId);\n      return;\n    }\n    setAttendance(prev => ({\n      ...prev,\n      [userId]: isPresent\n    }));\n  };\n\n  const handleSubmitAttendance = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${id}/attendance`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          attendanceData: attendance\n        })\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        console.log('Attendance saved successfully:', result.message);\n        setAttendanceSaved(true); // Mark attendance as saved\n        // Show success message\n        alert('Attendance submitted successfully! This cannot be modified.');\n      } else {\n        const errorData = await response.json();\n        console.error('Failed to save attendance:', errorData.error);\n        alert(`Failed to save attendance: ${errorData.error}`);\n      }\n    } catch (error) {\n      console.error('Error submitting attendance:', error);\n      alert('Error submitting attendance. Please try again.');\n    }\n  };\n\n  const handleCommentSubmit = async (e) => {\n    e.preventDefault();\n    if (!newComment.trim()) return;\n\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const newCommentObj = {\n        id: Date.now(),\n        user_name: currentUser.name,\n        content: newComment.trim(),\n        created_at: new Date().toISOString()\n      };\n\n      setComments([...comments, newCommentObj]);\n      setNewComment('');\n    } catch (error) {\n      console.error('Error adding comment:', error);\n    }\n  };\n\n  if (loading) {\n    return <div className=\"loading\">Loading workout details...</div>;\n  }\n\n  if (!workout) {\n    return <div className=\"error\">Workout not found</div>;\n  }\n\n  return (\n    <div className=\"workout-detail-container\">\n      <div className=\"container\">\n        <button className=\"back-btn\" onClick={() => navigate('/forum')}>\n          ‚Üê Back to Forum\n        </button>\n\n        <div className=\"workout-detail-card\">\n          <div className=\"workout-header\">\n            <div className=\"workout-title-section\">\n              <h1 className=\"workout-title\">{workout.title}</h1>\n              {/* Edit and Delete buttons for workout author or executives */}\n              {(() => {\n                const canEdit = currentUser.id === workout.user_id || currentUser.role === 'exec' || currentUser.role === 'administrator';\n                console.log('üîç Edit button permission check:', {\n                  currentUserId: currentUser.id,\n                  workoutUserId: workout.user_id,\n                  currentUserRole: currentUser.role,\n                  isAuthor: currentUser.id === workout.user_id,\n                  isExec: currentUser.role === 'exec',\n                  isAdmin: currentUser.role === 'administrator',\n                  canEdit: canEdit\n                });\n                return canEdit;\n              })() && (\n                <div className=\"workout-actions-admin\">\n                  <button \n                    className=\"edit-btn\"\n                    onClick={handleEditWorkout}\n                    disabled={editMode}\n                  >\n                    ‚úèÔ∏è Edit\n                  </button>\n                  <button \n                    className=\"delete-btn\"\n                    onClick={handleDeleteWorkout}\n                    disabled={editMode}\n                  >\n                    üóëÔ∏è Delete\n                  </button>\n                </div>\n              )}\n            </div>\n            <div className=\"workout-author\">\n              <div className=\"author-info\">\n                                    {workout.authorProfilePictureUrl ? (\n                      <img \n                        src={`http://localhost:5001${workout.authorProfilePictureUrl}`} \n                        alt=\"Profile\" \n                        className=\"author-avatar\"\n                        onError={(e) => {\n                          e.target.src = '/images/default_profile.png';\n                        }}\n                      />\n                    ) : (\n                      <img \n                        src=\"/images/default_profile.png\" \n                        alt=\"Profile\" \n                        className=\"author-avatar\"\n                      />\n                    )}\n                <span className=\"author-name\">Posted by {workout.author_name}</span>\n              </div>\n            </div>\n          </div>\n\n          {workout.workout_type && (\n            <div className=\"workout-meta\">\n              <span className=\"workout-type-badge\">{workout.workout_type}</span>\n              {workout.workout_date && (\n                <span className=\"workout-date\">\n                  üìÖ {new Date(workout.workout_date).toLocaleDateString()}\n                  {workout.workout_time && (\n                    <span className=\"workout-time\"> ‚Ä¢ üïê {workout.workout_time}</span>\n                  )}\n                </span>\n              )}\n            </div>\n          )}\n\n          {editMode ? (\n            <div className=\"workout-edit-form\">\n              <div className=\"form-group\">\n                <label htmlFor=\"workout-title-input\">Title:</label>\n                <input\n                  id=\"workout-title-input\"\n                  type=\"text\"\n                  value={editedTitle}\n                  onChange={(e) => setEditedTitle(e.target.value)}\n                  className=\"form-input\"\n                  placeholder=\"Enter workout title...\"\n                />\n              </div>\n              \n              <div className=\"form-row\">\n                <div className=\"form-group\">\n                  <label htmlFor=\"workout-date-input\">Date:</label>\n                  <input\n                    id=\"workout-date-input\"\n                    type=\"date\"\n                    value={editedDate}\n                    onChange={(e) => setEditedDate(e.target.value)}\n                    className=\"form-input\"\n                  />\n                </div>\n                \n                <div className=\"form-group\">\n                  <label htmlFor=\"workout-time-input\">Time:</label>\n                  <input\n                    id=\"workout-time-input\"\n                    type=\"time\"\n                    value={editedTime}\n                    onChange={(e) => setEditedTime(e.target.value)}\n                    className=\"form-input\"\n                  />\n                </div>\n              </div>\n              \n              <div className=\"form-group\">\n                <label htmlFor=\"workout-content-input\">Description:</label>\n                <textarea\n                  id=\"workout-content-input\"\n                  value={editedContent}\n                  onChange={(e) => setEditedContent(e.target.value)}\n                  className=\"form-textarea\"\n                  rows=\"5\"\n                  placeholder=\"Enter workout description...\"\n                />\n              </div>\n              \n              <div className=\"edit-actions\">\n                <button \n                  className=\"btn btn-primary\" \n                  onClick={handleSaveWorkout}\n                  disabled={saving}\n                >\n                  {saving ? 'Saving...' : 'Save Changes'}\n                </button>\n                <button \n                  className=\"btn btn-secondary\" \n                  onClick={handleCancelEdit}\n                  disabled={saving}\n                >\n                  Cancel\n                </button>\n              </div>\n            </div>\n          ) : (\n            <div className=\"workout-content\">\n              {workout.content}\n            </div>\n          )}\n\n          <div className=\"workout-actions\">\n            <div className=\"button-group\">\n              <button \n                onClick={handleSignUp}\n                className={`signup-btn ${isSignedUp ? 'signed-up' : ''}`}\n                disabled={workout.capacity && signups.length >= workout.capacity && !isSignedUp}\n              >\n                {isSignedUp ? '‚úì Signed Up' : (workout.capacity && signups.length >= workout.capacity) ? 'Full' : 'Sign Up'}\n              </button>\n              \n              {/* Cancel button for signed-up users */}\n              {isSignedUp && (\n                <button \n                  onClick={handleCancelClick}\n                  className=\"cancel-btn\"\n                >\n                  Cancel\n                </button>\n              )}\n              \n              {/* Waitlist button for full workouts */}\n              {workout.capacity && signups.length >= workout.capacity && !isSignedUp && (\n                <button \n                  onClick={isOnWaitlist ? handleWaitlistLeave : handleWaitlistJoin}\n                  className={`waitlist-btn ${isOnWaitlist ? 'on-waitlist' : ''}`}\n                >\n                  {isOnWaitlist ? 'Leave Waitlist' : 'Join Waitlist'}\n                </button>\n              )}\n\n              {/* Position label when on waitlist */}\n              {workout.capacity && signups.length >= workout.capacity && isOnWaitlist && (\n                <span className=\"waitlist-position\">\n                  {`You're ${formatOrdinal(getWaitlistPosition())} on the waitlist`}\n                </span>\n              )}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"signups-section\">\n          <h2>Who's Coming ({signups.length}{workout.capacity ? `/${workout.capacity}` : ''})</h2>\n          {signups.length === 0 ? (\n            <p className=\"no-signups\">No one has signed up yet. Be the first!</p>\n          ) : (\n            <>\n              <div className=\"signups-list\">\n                {signups.map(signup => (\n                  <div key={signup.id} className=\"signup-item\">\n                    {/* Attendance checkbox for executives and administrators */}\n                    {currentUser && (currentUser.role === 'exec' || currentUser.role === 'administrator') && (\n                      <div className=\"attendance-checkbox\">\n                        <input\n                          type=\"checkbox\"\n                          id={`attendance-${signup.user_id}`}\n                          checked={attendance[signup.user_id] || false}\n                          onChange={(e) => {\n                            console.log('üîç Checkbox change for signup:', signup);\n                            handleAttendanceChange(signup.user_id, e.target.checked);\n                          }}\n                          disabled={attendanceSaved}\n                          title={attendanceSaved ? \"Attendance already submitted - cannot modify\" : \"Mark as present\"}\n                        />\n                        <label htmlFor={`attendance-${signup.user_id}`} className=\"sr-only\">\n                          Mark {signup.user_name} as present\n                        </label>\n                      </div>\n                    )}\n                    \n                    <div className=\"signup-user-info\">\n                      {signup.userProfilePictureUrl ? (\n                        <img \n                          src={`http://localhost:5001${signup.userProfilePictureUrl}`} \n                          alt=\"Profile\" \n                          className=\"user-avatar\"\n                          onError={(e) => {\n                            e.target.src = '/images/default_profile.png';\n                          }}\n                        />\n                      ) : (\n                        <img \n                          src=\"/images/default_profile.png\" \n                          alt=\"Profile\" \n                          className=\"user-avatar\"\n                        />\n                      )}\n                      <span className=\"signup-user\">{signup.user_name}</span>\n                    </div>\n                    <span className=\"signup-date\">\n                      üìÖ {new Date(signup.signed_up_at).toLocaleDateString()}\n                      <span className=\"signup-time\"> ‚Ä¢ üïê {new Date(signup.signed_up_at).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>\n                    </span>\n                  </div>\n                ))}\n              </div>\n              \n              {/* Submit attendance button for executives and administrators */}\n              {currentUser && (currentUser.role === 'exec' || currentUser.role === 'administrator') && signups.length > 0 && (\n                <div className=\"attendance-submit\">\n                  {attendanceSaved ? (\n                    <div className=\"attendance-locked\">\n                      <span className=\"locked-icon\">üîí</span>\n                      <span className=\"locked-text\">Attendance Submitted - Cannot be Modified</span>\n                    </div>\n                  ) : (\n                    <>\n                      <div className=\"attendance-debug\">\n                        <small>üìä {signups.length} signups ‚Ä¢ {Object.keys(attendance).length} attendance records</small>\n                      </div>\n                      <button \n                        onClick={handleSubmitAttendance}\n                        className=\"submit-attendance-btn\"\n                        title=\"Submit attendance and update absences (cannot be modified after submission)\"\n                      >\n                        üìù Submit Attendance\n                      </button>\n                    </>\n                  )}\n                </div>\n              )}\n            </>\n          )}\n        </div>\n\n        {/* Waitlist section */}\n        {workout.capacity && waitlist.length > 0 && (\n          <div className=\"waitlist-section\">\n            <h2>Waitlist ({waitlist.length})</h2>\n            <div className=\"waitlist-list\">\n              {waitlist.map(waitlistItem => (\n                <div key={waitlistItem.id} className=\"waitlist-item\">\n                  <div className=\"waitlist-user-info\">\n                    {waitlistItem.userProfilePictureUrl ? (\n                      <img \n                        src={`http://localhost:5001${waitlistItem.userProfilePictureUrl}`} \n                        alt=\"Profile\" \n                        className=\"user-avatar\"\n                        onError={(e) => {\n                          e.target.src = '/images/default_profile.png';\n                        }}\n                      />\n                    ) : (\n                      <img \n                        src=\"/images/default_profile.png\" \n                        alt=\"Profile\" \n                        className=\"user-avatar\"\n                      />\n                    )}\n                    <span className=\"waitlist-user\">{waitlistItem.user_name}</span>\n                  </div>\n                  <span className=\"waitlist-date\">\n                    üìÖ {new Date(waitlistItem.joined_at).toLocaleDateString()}\n                    <span className=\"waitlist-time\"> ‚Ä¢ üïê {new Date(waitlistItem.joined_at).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>\n                  </span>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        <div className=\"comments-section\">\n          <h2>Comments ({comments.length})</h2>\n          \n          <form onSubmit={handleCommentSubmit} className=\"comment-form\">\n            <textarea\n              value={newComment}\n              onChange={(e) => setNewComment(e.target.value)}\n              placeholder=\"Add a comment...\"\n              rows=\"3\"\n              maxLength=\"500\"\n              required\n            />\n            <button type=\"submit\" className=\"comment-submit-btn\">Post Comment</button>\n          </form>\n\n          {comments.length === 0 ? (\n            <p className=\"no-comments\">No comments yet. Start the conversation!</p>\n          ) : (\n            <div className=\"comments-list\">\n              {comments.map(comment => (\n                <div key={comment.id} className=\"comment-item\">\n                  <div className=\"comment-header\">\n                    <div className=\"comment-author-info\">\n                                          {comment.userProfilePictureUrl ? (\n                      <img \n                        src={`http://localhost:5001${comment.userProfilePictureUrl}`} \n                        alt=\"Profile\" \n                        className=\"user-avatar\"\n                        onError={(e) => {\n                          e.target.src = '/images/default_profile.png';\n                        }}\n                      />\n                    ) : (\n                      <img \n                        src=\"/images/default_profile.png\" \n                        alt=\"Profile\" \n                        className=\"user-avatar\"\n                      />\n                    )}\n                      <span className=\"comment-author\">{comment.user_name}</span>\n                    </div>\n                    <span className=\"comment-date\">\n                      {(() => {\n                        try {\n                          const date = new Date(comment.created_at);\n                          if (isNaN(date.getTime())) {\n                            return `üìÖ ${comment.created_at}`;\n                          }\n                          return (\n                            <>\n                              üìÖ {date.toLocaleDateString()}\n                              <span className=\"comment-time\"> ‚Ä¢ üïê {date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</span>\n                            </>\n                          );\n                        } catch (error) {\n                          return `üìÖ ${comment.created_at}`;\n                        }\n                      })()}\n                    </span>\n                  </div>\n                  <div className=\"comment-content\">{comment.content}</div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n\n        {/* Cancel Confirmation Modal */}\n        {showCancelModal && (\n          <div className=\"modal-overlay\">\n            <div className=\"modal\">\n              <h2>Cancel Workout Signup</h2>\n              <p>Are you sure you want to cancel your signup for this workout?</p>\n              <p className=\"warning-text\">\n                <strong>Warning:</strong> If you cancel less than 24 hours in advance, it will count as an absence. \n                Your absences are recorded and once you have three, you will be suspended from signing up for a week. \n                This is to keep it fair for all members!\n              </p>\n              <div className=\"modal-actions\">\n                <button onClick={handleCancelSignup} className=\"btn btn-danger\">Cancel Signup</button>\n                <button onClick={closeCancelModal} className=\"btn btn-secondary\">Keep Booking</button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default WorkoutDetail;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}