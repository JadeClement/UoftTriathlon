{"ast":null,"code":"import _objectSpread from\"/Users/jadeclement/Documents/Developer/uofttri/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useAuth}from'../context/AuthContext';import{useNavigate}from'react-router-dom';import'./Forum.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Forum=()=>{const{currentUser,isMember,isExec,getUserRole}=useAuth();const navigate=useNavigate();const[activeTab,setActiveTab]=useState('workouts');const[workoutPosts,setWorkoutPosts]=useState([]);const[eventPosts,setEventPosts]=useState([]);const[newWorkout,setNewWorkout]=useState('');const[newEvent,setNewEvent]=useState('');const[loading,setLoading]=useState(true);const[showWorkoutForm,setShowWorkoutForm]=useState(false);const[showEventForm,setShowEventForm]=useState(false);const[workoutFilter,setWorkoutFilter]=useState('all');const[workoutForm,setWorkoutForm]=useState({title:'',type:'spin',date:'',time:'',content:'',capacity:''});const[eventForm,setEventForm]=useState({title:'',date:'',content:''});const[workoutSignups,setWorkoutSignups]=useState({});const[workoutWaitlists,setWorkoutWaitlists]=useState({});const[showCancelModal,setShowCancelModal]=useState(false);const[workoutToCancel,setWorkoutToCancel]=useState(null);const[showPromotionMessage,setShowPromotionMessage]=useState(false);const[promotedWorkout,setPromotedWorkout]=useState(null);const API_BASE_URL='http://localhost:5001/api';useEffect(()=>{if(!currentUser){navigate('/login');return;}// Check if user has member access or higher\nif(!isMember(currentUser)){navigate('/login');return;}// Load forum posts from backend API\nloadForumPosts();},[currentUser,navigate,isMember]);const loadForumPosts=async()=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}// Load workout posts\nconst workoutResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(workoutResponse.ok){const workoutData=await workoutResponse.json();setWorkoutPosts(workoutData.posts||[]);// Load signup data for all workouts\nawait loadWorkoutSignups(workoutData.posts||[]);// Load waitlist data for all workouts\nawait loadWorkoutWaitlists(workoutData.posts||[]);}// Load event posts\nconst eventResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/events\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(eventResponse.ok){const eventData=await eventResponse.json();setEventPosts(eventData.posts||[]);}}catch(error){console.error('Error loading forum posts:',error);}finally{setLoading(false);}};const loadWorkoutSignups=async workouts=>{try{const token=localStorage.getItem('triathlonToken');if(!token)return;const signupsData={};for(const workout of workouts){const signupsResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(workout.id,\"/signups\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(signupsResponse.ok){const data=await signupsResponse.json();signupsData[workout.id]=data.signups||[];}}setWorkoutSignups(signupsData);}catch(error){console.error('Error loading workout signups:',error);}};const loadWorkoutWaitlists=async workouts=>{try{const token=localStorage.getItem('triathlonToken');if(!token)return;const waitlistData={};for(const workout of workouts){const waitlistResponse=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(workout.id,\"/waitlist\"),{headers:{'Authorization':\"Bearer \".concat(token)}});if(waitlistResponse.ok){const data=await waitlistResponse.json();waitlistData[workout.id]=data.waitlist||[];}}setWorkoutWaitlists(waitlistData);}catch(error){console.error('Error loading workout waitlists:',error);}};const handleWorkoutSignUp=async workoutId=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}// Check if user is already signed up\nconst isCurrentlySignedUp=isUserSignedUp(workoutId);if(!isCurrentlySignedUp){// Check capacity limit before allowing sign-up\nconst workout=workoutPosts.find(w=>w.id===workoutId);if(workout&&workout.capacity){var _workoutSignups$worko;const currentSignups=((_workoutSignups$worko=workoutSignups[workoutId])===null||_workoutSignups$worko===void 0?void 0:_workoutSignups$worko.length)||0;if(currentSignups>=workout.capacity){alert(\"Sorry, this workout is full! Maximum capacity: \".concat(workout.capacity,\" people.\"));return;}}}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(workoutId,\"/signup\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){const result=await response.json();// Update local signup state\nif(result.signedUp){// Add current user to signups\nsetWorkoutSignups(prev=>_objectSpread(_objectSpread({},prev),{},{[workoutId]:[...(prev[workoutId]||[]),{user_name:currentUser.name}]}));}else{// Remove current user from signups\nsetWorkoutSignups(prev=>_objectSpread(_objectSpread({},prev),{},{[workoutId]:(prev[workoutId]||[]).filter(s=>s.user_name!==currentUser.name)}));}}else{const error=await response.json();console.error('Error updating signup:',error.error);}}catch(error){console.error('Error updating signup:',error);}};const isUserSignedUp=workoutId=>{var _workoutSignups$worko2;return((_workoutSignups$worko2=workoutSignups[workoutId])===null||_workoutSignups$worko2===void 0?void 0:_workoutSignups$worko2.some(signup=>signup.user_name===currentUser.name))||false;};const isWorkoutFull=workoutId=>{var _workoutSignups$worko3;const workout=workoutPosts.find(w=>w.id===workoutId);if(!workout||!workout.capacity)return false;const currentSignups=((_workoutSignups$worko3=workoutSignups[workoutId])===null||_workoutSignups$worko3===void 0?void 0:_workoutSignups$worko3.length)||0;return currentSignups>=workout.capacity;};const isUserOnWaitlist=workoutId=>{var _workoutWaitlists$wor;return((_workoutWaitlists$wor=workoutWaitlists[workoutId])===null||_workoutWaitlists$wor===void 0?void 0:_workoutWaitlists$wor.some(waitlist=>waitlist.user_name===currentUser.name))||false;};// Returns 1-based position or null if not on waitlist\nconst getWaitlistPosition=workoutId=>{const list=workoutWaitlists[workoutId]||[];const idx=list.findIndex(w=>w.user_name===currentUser.name);return idx===-1?null:idx+1;};const formatOrdinal=n=>{if(n==null)return'';const s=[\"th\",\"st\",\"nd\",\"rd\"],v=n%100;return n+(s[(v-20)%10]||s[v]||s[0]);};const handleWaitlistJoin=async workoutId=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(workoutId,\"/waitlist\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){// Refresh waitlist data\nawait loadWorkoutWaitlists(workoutPosts);}else{const error=await response.json();alert(error.error||'Failed to join waitlist');}}catch(error){console.error('Error joining waitlist:',error);alert('Failed to join waitlist');}};const handleWaitlistLeave=async workoutId=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(workoutId,\"/waitlist\"),{method:'DELETE',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){// Refresh waitlist data\nawait loadWorkoutWaitlists(workoutPosts);}else{const error=await response.json();alert(error.error||'Failed to leave waitlist');}}catch(error){console.error('Error leaving waitlist:',error);alert('Failed to leave waitlist');}};const handleCancelClick=workoutId=>{setWorkoutToCancel(workoutId);setShowCancelModal(true);};const handleCancelConfirm=async()=>{if(!workoutToCancel)return;try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(workoutToCancel,\"/signup\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){// Refresh both signup and waitlist data since someone might have been promoted\nawait loadWorkoutSignups(workoutPosts);await loadWorkoutWaitlists(workoutPosts);setShowCancelModal(false);setWorkoutToCancel(null);}else{const error=await response.json();alert(error.error||'Failed to cancel signup');}}catch(error){console.error('Error canceling signup:',error);alert('Failed to cancel signup');}};const handleCancelCancel=()=>{setShowCancelModal(false);setWorkoutToCancel(null);};// Check if user was promoted from waitlist after data refresh\nconst checkForWaitlistPromotion=workoutId=>{var _workoutWaitlists$wor2,_workoutSignups$worko4;const wasOnWaitlist=(_workoutWaitlists$wor2=workoutWaitlists[workoutId])===null||_workoutWaitlists$wor2===void 0?void 0:_workoutWaitlists$wor2.some(w=>w.user_name===currentUser.name);const isNowSignedUp=(_workoutSignups$worko4=workoutSignups[workoutId])===null||_workoutSignups$worko4===void 0?void 0:_workoutSignups$worko4.some(s=>s.user_name===currentUser.name);if(wasOnWaitlist&&isNowSignedUp){// User was promoted from waitlist!\nconst workout=workoutPosts.find(w=>w.id===workoutId);setPromotedWorkout(workout);setShowPromotionMessage(true);// Auto-hide after 10 seconds\nsetTimeout(()=>{setShowPromotionMessage(false);setPromotedWorkout(null);},10000);}};const handleSubmitWorkout=async e=>{e.preventDefault();if(!workoutForm.title.trim()||!workoutForm.date||!workoutForm.time||!workoutForm.content.trim())return;// Check if the selected date is in the future\nconst selectedDate=new Date(workoutForm.date);const today=new Date();today.setHours(0,0,0,0);// Reset time to start of day for accurate comparison\nif(selectedDate<=today){alert('Please select a future date for your workout.');return;}try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify({title:workoutForm.title.trim(),workoutType:workoutForm.type,workoutDate:workoutForm.date,workoutTime:workoutForm.time,content:workoutForm.content.trim(),capacity:workoutForm.capacity?parseInt(workoutForm.capacity):null,type:'workout'})});if(response.ok){const newPostData=await response.json();setWorkoutPosts([newPostData.post,...workoutPosts]);setWorkoutForm({title:'',type:'spin',date:'',time:'',content:'',capacity:''});setShowWorkoutForm(false);}else{console.error('Failed to create workout post');}}catch(error){console.error('Error creating workout post:',error);}};const handleSubmitEvent=async e=>{e.preventDefault();if(!eventForm.title.trim()||!eventForm.date||!eventForm.content.trim())return;// Check if the selected date is in the future\nconst selectedDate=new Date(eventForm.date);const today=new Date();today.setHours(0,0,0,0);// Reset time to start of day for accurate comparison\nif(selectedDate<=today){alert('Please select a future date for your event.');return;}try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/events\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token),'Content-Type':'application/json'},body:JSON.stringify({title:eventForm.title.trim(),eventDate:eventForm.date,content:eventForm.content.trim(),type:'event'})});if(response.ok){const newPostData=await response.json();setEventPosts([newPostData.post,...eventPosts]);setEventForm({title:'',date:'',content:''});setShowEventForm(false);}else{console.error('Failed to create event post');}}catch(error){console.error('Error creating event post:',error);}};const handleLike=async postId=>{try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/posts/\").concat(postId,\"/like\"),{method:'POST',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){// Reload posts to get updated like count\nloadForumPosts();}else{console.error('Failed to like post');}}catch(error){console.error('Error liking post:',error);}};const handleDeleteWorkout=async postId=>{if(!window.confirm('Are you sure you want to delete this workout post?')){return;}try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/workouts/\").concat(postId),{method:'DELETE',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){loadForumPosts();}else{console.error('Failed to delete workout post');}}catch(error){console.error('Error deleting workout post:',error);}};const handleDeleteEvent=async postId=>{if(!window.confirm('Are you sure you want to delete this event post?')){return;}try{const token=localStorage.getItem('triathlonToken');if(!token){console.error('No authentication token found');return;}const response=await fetch(\"\".concat(API_BASE_URL,\"/forum/events/\").concat(postId),{method:'DELETE',headers:{'Authorization':\"Bearer \".concat(token)}});if(response.ok){loadForumPosts();}else{console.error('Failed to delete event post');}}catch(error){console.error('Error deleting event post:',error);}};// Filter workouts based on selected filter\nconst getFilteredWorkouts=()=>{if(workoutFilter==='all'){return workoutPosts;}return workoutPosts.filter(post=>{switch(workoutFilter){case'bike':return post.workout_type==='spin'||post.workout_type==='outdoor-ride'||post.workout_type==='brick';case'swim':return post.workout_type==='swim';case'run':return post.workout_type==='run';default:return true;}});};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading...\"});}if(!currentUser){return null;}return/*#__PURE__*/_jsx(\"div\",{className:\"forum-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"section-title\",children:\"Team Forum\"}),/*#__PURE__*/_jsx(\"p\",{className:\"section-subtitle\",children:\"Connect with your teammates and discuss training, races, and more!\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"forum-tabs\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"tab-button \".concat(activeTab==='workouts'?'active':''),onClick:()=>setActiveTab('workouts'),children:\"\\uD83C\\uDFC3\\u200D\\u2642\\uFE0F Workouts\"}),/*#__PURE__*/_jsx(\"button\",{className:\"tab-button \".concat(activeTab==='events'?'active':''),onClick:()=>setActiveTab('events'),children:\"\\uD83C\\uDF89 Events\"})]}),activeTab==='workouts'&&/*#__PURE__*/_jsxs(\"div\",{className:\"workouts-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Workout Posts\"}),isExec(currentUser)&&/*#__PURE__*/_jsx(\"button\",{className:\"new-post-btn\",onClick:()=>setShowWorkoutForm(true),children:\"+ New Workout\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"workout-filters\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"filter-btn \".concat(workoutFilter==='all'?'active':''),onClick:()=>setWorkoutFilter('all'),children:\"\\uD83C\\uDFC3\\u200D\\u2642\\uFE0F All Workouts\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filter-btn \".concat(workoutFilter==='bike'?'active':''),onClick:()=>setWorkoutFilter('bike'),children:\"\\uD83D\\uDEB4\\u200D\\u2642\\uFE0F Bike (Indoor/Outdoor/Brick)\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filter-btn \".concat(workoutFilter==='swim'?'active':''),onClick:()=>setWorkoutFilter('swim'),children:\"\\uD83C\\uDFCA\\u200D\\u2642\\uFE0F Swim\"}),/*#__PURE__*/_jsx(\"button\",{className:\"filter-btn \".concat(workoutFilter==='run'?'active':''),onClick:()=>setWorkoutFilter('run'),children:\"\\uD83C\\uDFC3\\u200D\\u2640\\uFE0F Run\"})]}),getFilteredWorkouts().length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-posts\",children:workoutPosts.length===0?'No workout posts yet.':\"No \".concat(workoutFilter==='all'?'':workoutFilter,\" workouts found.\")}):/*#__PURE__*/_jsx(\"div\",{className:\"posts-list\",children:getFilteredWorkouts().map(post=>{var _workoutSignups$post$,_workoutSignups$post$2,_workoutWaitlists$pos;return/*#__PURE__*/_jsxs(\"div\",{className:\"post-card workout-post\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post-header\",children:[post.title&&/*#__PURE__*/_jsx(\"div\",{className:\"workout-title\",children:/*#__PURE__*/_jsx(\"h2\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/workout/\".concat(post.id),className:\"workout-title-link\",children:post.title})})}),currentUser.id===post.user_id&&/*#__PURE__*/_jsx(\"button\",{className:\"delete-btn\",onClick:()=>handleDeleteWorkout(post.id),children:\"\\uD83D\\uDDD1\\uFE0F Delete\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"workout-author\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"author-info\",children:[post.authorProfilePictureUrl?/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:5001\".concat(post.authorProfilePictureUrl),alt:\"Profile\",className:\"author-avatar\"}):/*#__PURE__*/_jsx(\"div\",{className:\"author-avatar-placeholder\",children:/*#__PURE__*/_jsx(\"span\",{children:post.author_name?post.author_name.charAt(0).toUpperCase():'U'})}),/*#__PURE__*/_jsxs(\"span\",{className:\"author-name\",children:[\"Posted by \",post.author_name]})]})}),post.workout_type&&/*#__PURE__*/_jsxs(\"div\",{className:\"workout-meta\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"workout-type-badge\",children:post.workout_type}),post.workout_date&&/*#__PURE__*/_jsxs(\"span\",{className:\"workout-date\",children:[\"\\uD83D\\uDCC5 \",new Date(post.workout_date).toLocaleDateString(),post.workout_time&&/*#__PURE__*/_jsxs(\"span\",{className:\"workout-time\",children:[\" \\u2022 \\uD83D\\uDD50 \",post.workout_time]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"workout-signup-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"button-group\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"signup-btn \".concat(isUserSignedUp(post.id)?'signed-up':'',\" \").concat(isWorkoutFull(post.id)?'full':''),onClick:()=>handleWorkoutSignUp(post.id),disabled:isWorkoutFull(post.id)&&!isUserSignedUp(post.id),children:isUserSignedUp(post.id)?'✓ Signed Up':isWorkoutFull(post.id)?'Full':'Sign Up'}),isUserSignedUp(post.id)&&/*#__PURE__*/_jsx(\"button\",{className:\"cancel-btn\",onClick:()=>handleCancelClick(post.id),children:\"Cancel\"}),post.capacity&&isWorkoutFull(post.id)&&!isUserSignedUp(post.id)&&/*#__PURE__*/_jsx(\"button\",{className:\"waitlist-btn \".concat(isUserOnWaitlist(post.id)?'on-waitlist':''),onClick:()=>isUserOnWaitlist(post.id)?handleWaitlistLeave(post.id):handleWaitlistJoin(post.id),children:isUserOnWaitlist(post.id)?'Leave Waitlist':'Join Waitlist'}),post.capacity&&isWorkoutFull(post.id)&&isUserOnWaitlist(post.id)&&/*#__PURE__*/_jsx(\"span\",{className:\"waitlist-position\",children:\"You're \".concat(formatOrdinal(getWaitlistPosition(post.id)),\" on the waitlist\")})]}),/*#__PURE__*/_jsxs(\"span\",{className:\"signup-count\",children:[post.capacity?\"\".concat(((_workoutSignups$post$=workoutSignups[post.id])===null||_workoutSignups$post$===void 0?void 0:_workoutSignups$post$.length)||0,\"/\").concat(post.capacity,\" signed up\"):\"\".concat(((_workoutSignups$post$2=workoutSignups[post.id])===null||_workoutSignups$post$2===void 0?void 0:_workoutSignups$post$2.length)||0,\" signed up\"),post.capacity&&/*#__PURE__*/_jsx(\"span\",{className:\"capacity-status \".concat(isWorkoutFull(post.id)?'full':'available'),children:isWorkoutFull(post.id)?' (Full)':' (Available)'}),post.capacity&&((_workoutWaitlists$pos=workoutWaitlists[post.id])===null||_workoutWaitlists$pos===void 0?void 0:_workoutWaitlists$pos.length)>0&&/*#__PURE__*/_jsxs(\"span\",{className:\"waitlist-count\",children:[\"\\u2022 \",workoutWaitlists[post.id].length,\" on waitlist\"]})]})]})]},post.id);})})]}),activeTab==='events'&&/*#__PURE__*/_jsxs(\"div\",{className:\"events-section\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"section-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Event Posts\"}),isExec(currentUser)&&/*#__PURE__*/_jsx(\"button\",{className:\"new-post-btn\",onClick:()=>setShowEventForm(true),children:\"+ New Event\"})]}),eventPosts.length===0?/*#__PURE__*/_jsx(\"p\",{className:\"no-posts\",children:\"No event posts yet.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"posts-list\",children:eventPosts.map(post=>/*#__PURE__*/_jsxs(\"div\",{className:\"post-card event-post\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"post-header\",children:[post.title&&/*#__PURE__*/_jsx(\"div\",{className:\"event-title\",children:/*#__PURE__*/_jsx(\"h3\",{children:/*#__PURE__*/_jsx(\"a\",{href:\"/event/\".concat(post.id),className:\"event-title-link\",children:post.title})})}),currentUser.id===post.user_id&&/*#__PURE__*/_jsx(\"button\",{className:\"delete-btn\",onClick:()=>handleDeleteEvent(post.id),children:\"\\uD83D\\uDDD1\\uFE0F Delete\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"event-author\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"author-info\",children:[post.authorProfilePictureUrl?/*#__PURE__*/_jsx(\"img\",{src:\"http://localhost:5001\".concat(post.authorProfilePictureUrl),alt:\"Profile\",className:\"author-avatar\"}):/*#__PURE__*/_jsx(\"div\",{className:\"author-avatar-placeholder\",children:/*#__PURE__*/_jsx(\"span\",{children:post.author_name?post.author_name.charAt(0).toUpperCase():'U'})}),/*#__PURE__*/_jsxs(\"span\",{className:\"author-name\",children:[\"Posted by \",post.author_name]})]})}),post.event_date&&/*#__PURE__*/_jsx(\"div\",{className:\"event-meta\",children:/*#__PURE__*/_jsxs(\"span\",{className:\"event-date\",children:[\"\\uD83D\\uDCC5 \",new Date(post.event_date).toLocaleDateString()]})}),/*#__PURE__*/_jsx(\"div\",{className:\"post-footer\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"rsvp-buttons\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"rsvp-btn going\",children:\"Going\"}),/*#__PURE__*/_jsx(\"button\",{className:\"rsvp-btn maybe\",children:\"Maybe\"}),/*#__PURE__*/_jsx(\"button\",{className:\"rsvp-btn not-going\",children:\"Not Going\"})]})})]},post.id))})]}),showPromotionMessage&&promotedWorkout&&/*#__PURE__*/_jsx(\"div\",{className:\"promotion-message\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"promotion-content\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"\\uD83C\\uDF89 Congratulations!\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"You've been promoted from the waitlist for \",/*#__PURE__*/_jsx(\"strong\",{children:promotedWorkout.title}),\"!\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"Check your email for details. You're now officially signed up for this workout.\"}),/*#__PURE__*/_jsx(\"button\",{className:\"promotion-close-btn\",onClick:()=>setShowPromotionMessage(false),children:\"\\u2715\"})]})}),showCancelModal&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal cancel-modal\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Cancel Workout Signup\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"cancel-warning\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"\\u26A0\\uFE0F \",/*#__PURE__*/_jsx(\"strong\",{children:\"Important:\"}),\" If you cancel less than 24 hours in advance, it will count as an absence.\"]}),/*#__PURE__*/_jsx(\"p\",{children:\"Your absences are recorded and once you have three, you will be suspended from signing up for a week.\"}),/*#__PURE__*/_jsx(\"p\",{children:\"This is to keep it fair for all members!\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn-secondary\",onClick:handleCancelCancel,children:\"Keep Booking\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn-danger\",onClick:handleCancelConfirm,children:\"Cancel\"})]})]})}),showWorkoutForm&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create New Workout Post\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitWorkout,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Workout Title:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:workoutForm.title,onChange:e=>setWorkoutForm(_objectSpread(_objectSpread({},workoutForm),{},{title:e.target.value})),placeholder:\"e.g., Tuesday Morning Swim, Weekend Long Run\",maxLength:\"100\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Workout Type:\"}),/*#__PURE__*/_jsxs(\"select\",{value:workoutForm.type,onChange:e=>setWorkoutForm(_objectSpread(_objectSpread({},workoutForm),{},{type:e.target.value})),required:true,children:[/*#__PURE__*/_jsx(\"option\",{value:\"spin\",children:\"Spin\"}),/*#__PURE__*/_jsx(\"option\",{value:\"outdoor-ride\",children:\"Outdoor Ride\"}),/*#__PURE__*/_jsx(\"option\",{value:\"run\",children:\"Run\"}),/*#__PURE__*/_jsx(\"option\",{value:\"swim\",children:\"Swim\"}),/*#__PURE__*/_jsx(\"option\",{value:\"brick\",children:\"Brick (Bike + Run)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"other\",children:\"Other\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Workout Date:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:workoutForm.date,onChange:e=>setWorkoutForm(_objectSpread(_objectSpread({},workoutForm),{},{date:e.target.value})),min:new Date().toISOString().split('T')[0],required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Workout Time:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",value:workoutForm.time,onChange:e=>setWorkoutForm(_objectSpread(_objectSpread({},workoutForm),{},{time:e.target.value})),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Additional Details:\"}),/*#__PURE__*/_jsx(\"textarea\",{value:workoutForm.content,onChange:e=>setWorkoutForm(_objectSpread(_objectSpread({},workoutForm),{},{content:e.target.value})),placeholder:\"Describe the workout, time, location, requirements, what to bring...\",rows:\"4\",maxLength:\"500\",required:true}),/*#__PURE__*/_jsxs(\"small\",{className:\"char-count\",children:[workoutForm.content.length,\"/500\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Capacity (Optional):\"}),/*#__PURE__*/_jsx(\"input\",{type:\"number\",value:workoutForm.capacity,onChange:e=>setWorkoutForm(_objectSpread(_objectSpread({},workoutForm),{},{capacity:e.target.value})),placeholder:\"Leave empty for unlimited spots\",min:\"1\",max:\"100\"}),/*#__PURE__*/_jsx(\"small\",{children:\"Maximum number of people who can sign up. Leave empty for unlimited spots.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:\"Post Workout\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",onClick:()=>setShowWorkoutForm(false),children:\"Cancel\"})]})]})]})}),showEventForm&&/*#__PURE__*/_jsx(\"div\",{className:\"modal-overlay\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Create New Event Post\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmitEvent,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Event Title:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:eventForm.title,onChange:e=>setEventForm(_objectSpread(_objectSpread({},eventForm),{},{title:e.target.value})),placeholder:\"e.g., Club Social Night, Race Watch Party\",maxLength:\"100\",required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Event Date:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",value:eventForm.date,onChange:e=>setEventForm(_objectSpread(_objectSpread({},eventForm),{},{date:e.target.value})),min:new Date().toISOString().split('T')[0],required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Event Details:\"}),/*#__PURE__*/_jsx(\"textarea\",{value:eventForm.content,onChange:e=>setEventForm(_objectSpread(_objectSpread({},eventForm),{},{content:e.target.value})),placeholder:\"Describe the event, time, location, what to bring, RSVP details...\",rows:\"4\",maxLength:\"500\",required:true}),/*#__PURE__*/_jsxs(\"small\",{className:\"char-count\",children:[eventForm.content.length,\"/500\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"modal-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-primary\",children:\"Post Event\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-secondary\",onClick:()=>setShowEventForm(false),children:\"Cancel\"})]})]})]})})]})});};export default Forum;","map":{"version":3,"names":["React","useState","useEffect","useAuth","useNavigate","jsx","_jsx","jsxs","_jsxs","Forum","currentUser","isMember","isExec","getUserRole","navigate","activeTab","setActiveTab","workoutPosts","setWorkoutPosts","eventPosts","setEventPosts","newWorkout","setNewWorkout","newEvent","setNewEvent","loading","setLoading","showWorkoutForm","setShowWorkoutForm","showEventForm","setShowEventForm","workoutFilter","setWorkoutFilter","workoutForm","setWorkoutForm","title","type","date","time","content","capacity","eventForm","setEventForm","workoutSignups","setWorkoutSignups","workoutWaitlists","setWorkoutWaitlists","showCancelModal","setShowCancelModal","workoutToCancel","setWorkoutToCancel","showPromotionMessage","setShowPromotionMessage","promotedWorkout","setPromotedWorkout","API_BASE_URL","loadForumPosts","token","localStorage","getItem","console","error","workoutResponse","fetch","concat","headers","ok","workoutData","json","posts","loadWorkoutSignups","loadWorkoutWaitlists","eventResponse","eventData","workouts","signupsData","workout","signupsResponse","id","data","signups","waitlistData","waitlistResponse","waitlist","handleWorkoutSignUp","workoutId","isCurrentlySignedUp","isUserSignedUp","find","w","_workoutSignups$worko","currentSignups","length","alert","response","method","result","signedUp","prev","_objectSpread","user_name","name","filter","s","_workoutSignups$worko2","some","signup","isWorkoutFull","_workoutSignups$worko3","isUserOnWaitlist","_workoutWaitlists$wor","getWaitlistPosition","list","idx","findIndex","formatOrdinal","n","v","handleWaitlistJoin","handleWaitlistLeave","handleCancelClick","handleCancelConfirm","handleCancelCancel","checkForWaitlistPromotion","_workoutWaitlists$wor2","_workoutSignups$worko4","wasOnWaitlist","isNowSignedUp","setTimeout","handleSubmitWorkout","e","preventDefault","trim","selectedDate","Date","today","setHours","body","JSON","stringify","workoutType","workoutDate","workoutTime","parseInt","newPostData","post","handleSubmitEvent","eventDate","handleLike","postId","handleDeleteWorkout","window","confirm","handleDeleteEvent","getFilteredWorkouts","workout_type","className","children","onClick","map","_workoutSignups$post$","_workoutSignups$post$2","_workoutWaitlists$pos","href","user_id","authorProfilePictureUrl","src","alt","author_name","charAt","toUpperCase","workout_date","toLocaleDateString","workout_time","disabled","event_date","onSubmit","value","onChange","target","placeholder","maxLength","required","min","toISOString","split","rows","max"],"sources":["/Users/jadeclement/Documents/Developer/uofttri/src/components/Forum.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../context/AuthContext';\nimport { useNavigate } from 'react-router-dom';\nimport './Forum.css';\n\nconst Forum = () => {\n  const { currentUser, isMember, isExec, getUserRole } = useAuth();\n  const navigate = useNavigate();\n  const [activeTab, setActiveTab] = useState('workouts');\n  const [workoutPosts, setWorkoutPosts] = useState([]);\n  const [eventPosts, setEventPosts] = useState([]);\n  const [newWorkout, setNewWorkout] = useState('');\n  const [newEvent, setNewEvent] = useState('');\n  const [loading, setLoading] = useState(true);\n  const [showWorkoutForm, setShowWorkoutForm] = useState(false);\n  const [showEventForm, setShowEventForm] = useState(false);\n  const [workoutFilter, setWorkoutFilter] = useState('all');\n  const [workoutForm, setWorkoutForm] = useState({\n    title: '',\n    type: 'spin',\n    date: '',\n    time: '',\n    content: '',\n    capacity: ''\n  });\n  const [eventForm, setEventForm] = useState({\n    title: '',\n    date: '',\n    content: ''\n  });\n  const [workoutSignups, setWorkoutSignups] = useState({});\n  const [workoutWaitlists, setWorkoutWaitlists] = useState({});\n  const [showCancelModal, setShowCancelModal] = useState(false);\n  const [workoutToCancel, setWorkoutToCancel] = useState(null);\n  const [showPromotionMessage, setShowPromotionMessage] = useState(false);\n  const [promotedWorkout, setPromotedWorkout] = useState(null);\n\n  const API_BASE_URL = 'http://localhost:5001/api';\n\n  useEffect(() => {\n    if (!currentUser) {\n      navigate('/login');\n      return;\n    }\n    \n    // Check if user has member access or higher\n    if (!isMember(currentUser)) {\n      navigate('/login');\n      return;\n    }\n    \n    // Load forum posts from backend API\n    loadForumPosts();\n  }, [currentUser, navigate, isMember]);\n\n  const loadForumPosts = async () => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      // Load workout posts\n      const workoutResponse = await fetch(`${API_BASE_URL}/forum/workouts`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (workoutResponse.ok) {\n        const workoutData = await workoutResponse.json();\n        setWorkoutPosts(workoutData.posts || []);\n        \n        // Load signup data for all workouts\n        await loadWorkoutSignups(workoutData.posts || []);\n        // Load waitlist data for all workouts\n        await loadWorkoutWaitlists(workoutData.posts || []);\n      }\n\n      // Load event posts\n      const eventResponse = await fetch(`${API_BASE_URL}/forum/events`, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (eventResponse.ok) {\n        const eventData = await eventResponse.json();\n        setEventPosts(eventData.posts || []);\n      }\n    } catch (error) {\n      console.error('Error loading forum posts:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadWorkoutSignups = async (workouts) => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) return;\n\n      const signupsData = {};\n      \n      for (const workout of workouts) {\n        const signupsResponse = await fetch(`${API_BASE_URL}/forum/workouts/${workout.id}/signups`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n        \n        if (signupsResponse.ok) {\n          const data = await signupsResponse.json();\n          signupsData[workout.id] = data.signups || [];\n        }\n      }\n      \n      setWorkoutSignups(signupsData);\n    } catch (error) {\n      console.error('Error loading workout signups:', error);\n    }\n  };\n\n  const loadWorkoutWaitlists = async (workouts) => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) return;\n\n      const waitlistData = {};\n      \n      for (const workout of workouts) {\n        const waitlistResponse = await fetch(`${API_BASE_URL}/forum/workouts/${workout.id}/waitlist`, {\n          headers: {\n            'Authorization': `Bearer ${token}`\n          }\n        });\n\n        if (waitlistResponse.ok) {\n          const data = await waitlistResponse.json();\n          waitlistData[workout.id] = data.waitlist || [];\n        }\n      }\n      \n      setWorkoutWaitlists(waitlistData);\n    } catch (error) {\n      console.error('Error loading workout waitlists:', error);\n    }\n  };\n\n  const handleWorkoutSignUp = async (workoutId) => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      // Check if user is already signed up\n      const isCurrentlySignedUp = isUserSignedUp(workoutId);\n      \n      if (!isCurrentlySignedUp) {\n        // Check capacity limit before allowing sign-up\n        const workout = workoutPosts.find(w => w.id === workoutId);\n        if (workout && workout.capacity) {\n          const currentSignups = workoutSignups[workoutId]?.length || 0;\n          if (currentSignups >= workout.capacity) {\n            alert(`Sorry, this workout is full! Maximum capacity: ${workout.capacity} people.`);\n            return;\n          }\n        }\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${workoutId}/signup`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        \n        // Update local signup state\n        if (result.signedUp) {\n          // Add current user to signups\n          setWorkoutSignups(prev => ({\n            ...prev,\n            [workoutId]: [...(prev[workoutId] || []), { user_name: currentUser.name }]\n          }));\n        } else {\n          // Remove current user from signups\n          setWorkoutSignups(prev => ({\n            ...prev,\n            [workoutId]: (prev[workoutId] || []).filter(s => s.user_name !== currentUser.name)\n          }));\n        }\n      } else {\n        const error = await response.json();\n        console.error('Error updating signup:', error.error);\n      }\n    } catch (error) {\n      console.error('Error updating signup:', error);\n    }\n  };\n\n  const isUserSignedUp = (workoutId) => {\n    return workoutSignups[workoutId]?.some(signup => signup.user_name === currentUser.name) || false;\n  };\n\n  const isWorkoutFull = (workoutId) => {\n    const workout = workoutPosts.find(w => w.id === workoutId);\n    if (!workout || !workout.capacity) return false;\n    const currentSignups = workoutSignups[workoutId]?.length || 0;\n    return currentSignups >= workout.capacity;\n  };\n\n  const isUserOnWaitlist = (workoutId) => {\n    return workoutWaitlists[workoutId]?.some(waitlist => waitlist.user_name === currentUser.name) || false;\n  };\n\n  // Returns 1-based position or null if not on waitlist\n  const getWaitlistPosition = (workoutId) => {\n    const list = workoutWaitlists[workoutId] || [];\n    const idx = list.findIndex(w => w.user_name === currentUser.name);\n    return idx === -1 ? null : idx + 1;\n  };\n\n  const formatOrdinal = (n) => {\n    if (n == null) return '';\n    const s = [\"th\",\"st\",\"nd\",\"rd\"], v = n % 100;\n    return n + (s[(v-20)%10] || s[v] || s[0]);\n  };\n\n  const handleWaitlistJoin = async (workoutId) => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${workoutId}/waitlist`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        // Refresh waitlist data\n        await loadWorkoutWaitlists(workoutPosts);\n      } else {\n        const error = await response.json();\n        alert(error.error || 'Failed to join waitlist');\n      }\n    } catch (error) {\n      console.error('Error joining waitlist:', error);\n      alert('Failed to join waitlist');\n    }\n  };\n\n  const handleWaitlistLeave = async (workoutId) => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${workoutId}/waitlist`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        // Refresh waitlist data\n        await loadWorkoutWaitlists(workoutPosts);\n      } else {\n        const error = await response.json();\n        alert(error.error || 'Failed to leave waitlist');\n      }\n    } catch (error) {\n      console.error('Error leaving waitlist:', error);\n      alert('Failed to leave waitlist');\n    }\n  };\n\n  const handleCancelClick = (workoutId) => {\n    setWorkoutToCancel(workoutId);\n    setShowCancelModal(true);\n  };\n\n  const handleCancelConfirm = async () => {\n    if (!workoutToCancel) return;\n    \n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${workoutToCancel}/signup`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        // Refresh both signup and waitlist data since someone might have been promoted\n        await loadWorkoutSignups(workoutPosts);\n        await loadWorkoutWaitlists(workoutPosts);\n        setShowCancelModal(false);\n        setWorkoutToCancel(null);\n      } else {\n        const error = await response.json();\n        alert(error.error || 'Failed to cancel signup');\n      }\n    } catch (error) {\n      console.error('Error canceling signup:', error);\n      alert('Failed to cancel signup');\n    }\n  };\n\n  const handleCancelCancel = () => {\n    setShowCancelModal(false);\n    setWorkoutToCancel(null);\n  };\n\n  // Check if user was promoted from waitlist after data refresh\n  const checkForWaitlistPromotion = (workoutId) => {\n    const wasOnWaitlist = workoutWaitlists[workoutId]?.some(w => w.user_name === currentUser.name);\n    const isNowSignedUp = workoutSignups[workoutId]?.some(s => s.user_name === currentUser.name);\n    \n    if (wasOnWaitlist && isNowSignedUp) {\n      // User was promoted from waitlist!\n      const workout = workoutPosts.find(w => w.id === workoutId);\n      setPromotedWorkout(workout);\n      setShowPromotionMessage(true);\n      \n      // Auto-hide after 10 seconds\n      setTimeout(() => {\n        setShowPromotionMessage(false);\n        setPromotedWorkout(null);\n      }, 10000);\n    }\n  };\n\n  const handleSubmitWorkout = async (e) => {\n    e.preventDefault();\n    if (!workoutForm.title.trim() || !workoutForm.date || !workoutForm.time || !workoutForm.content.trim()) return;\n\n    // Check if the selected date is in the future\n    const selectedDate = new Date(workoutForm.date);\n    const today = new Date();\n    today.setHours(0, 0, 0, 0); // Reset time to start of day for accurate comparison\n    \n    if (selectedDate <= today) {\n      alert('Please select a future date for your workout.');\n      return;\n    }\n\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          title: workoutForm.title.trim(),\n          workoutType: workoutForm.type,\n          workoutDate: workoutForm.date,\n          workoutTime: workoutForm.time,\n          content: workoutForm.content.trim(),\n          capacity: workoutForm.capacity ? parseInt(workoutForm.capacity) : null,\n          type: 'workout'\n        })\n      });\n\n      if (response.ok) {\n        const newPostData = await response.json();\n        setWorkoutPosts([newPostData.post, ...workoutPosts]);\n        setWorkoutForm({\n          title: '',\n          type: 'spin',\n          date: '',\n          time: '',\n          content: '',\n          capacity: ''\n        });\n        setShowWorkoutForm(false);\n      } else {\n        console.error('Failed to create workout post');\n      }\n    } catch (error) {\n        console.error('Error creating workout post:', error);\n    }\n  };\n\n  const handleSubmitEvent = async (e) => {\n    e.preventDefault();\n    if (!eventForm.title.trim() || !eventForm.date || !eventForm.content.trim()) return;\n\n    // Check if the selected date is in the future\n    const selectedDate = new Date(eventForm.date);\n    const today = new Date();\n    today.setHours(0, 0, 0, 0); // Reset time to start of day for accurate comparison\n    \n    if (selectedDate <= today) {\n      alert('Please select a future date for your event.');\n      return;\n    }\n\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/events`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          title: eventForm.title.trim(),\n          eventDate: eventForm.date,\n          content: eventForm.content.trim(),\n          type: 'event'\n        })\n      });\n\n      if (response.ok) {\n        const newPostData = await response.json();\n        setEventPosts([newPostData.post, ...eventPosts]);\n        setEventForm({\n          title: '',\n          date: '',\n          content: ''\n        });\n        setShowEventForm(false);\n      } else {\n        console.error('Failed to create event post');\n      }\n    } catch (error) {\n      console.error('Error creating event post:', error);\n    }\n  };\n\n  const handleLike = async (postId) => {\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/posts/${postId}/like`, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        // Reload posts to get updated like count\n        loadForumPosts();\n      } else {\n        console.error('Failed to like post');\n      }\n    } catch (error) {\n      console.error('Error liking post:', error);\n    }\n  };\n\n  const handleDeleteWorkout = async (postId) => {\n    if (!window.confirm('Are you sure you want to delete this workout post?')) {\n      return;\n    }\n\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/workouts/${postId}`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        loadForumPosts();\n      } else {\n        console.error('Failed to delete workout post');\n      }\n    } catch (error) {\n      console.error('Error deleting workout post:', error);\n    }\n  };\n\n  const handleDeleteEvent = async (postId) => {\n    if (!window.confirm('Are you sure you want to delete this event post?')) {\n      return;\n    }\n\n    try {\n      const token = localStorage.getItem('triathlonToken');\n      if (!token) {\n        console.error('No authentication token found');\n        return;\n      }\n\n      const response = await fetch(`${API_BASE_URL}/forum/events/${postId}`, {\n        method: 'DELETE',\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      });\n\n      if (response.ok) {\n        loadForumPosts();\n      } else {\n        console.error('Failed to delete event post');\n      }\n    } catch (error) {\n      console.error('Error deleting event post:', error);\n    }\n  };\n\n  // Filter workouts based on selected filter\n  const getFilteredWorkouts = () => {\n    if (workoutFilter === 'all') {\n      return workoutPosts;\n    }\n    \n    return workoutPosts.filter(post => {\n      switch (workoutFilter) {\n        case 'bike':\n          return post.workout_type === 'spin' || post.workout_type === 'outdoor-ride' || post.workout_type === 'brick';\n        case 'swim':\n          return post.workout_type === 'swim';\n        case 'run':\n          return post.workout_type === 'run';\n        default:\n          return true;\n      }\n    });\n  };\n\n  if (loading) {\n    return <div className=\"loading\">Loading...</div>;\n  }\n\n  if (!currentUser) {\n    return null;\n  }\n\n  return (\n    <div className=\"forum-container\">\n      <div className=\"container\">\n        <h1 className=\"section-title\">Team Forum</h1>\n        <p className=\"section-subtitle\">Connect with your teammates and discuss training, races, and more!</p>\n        \n        {/* Forum Tabs */}\n        <div className=\"forum-tabs\">\n          <button \n            className={`tab-button ${activeTab === 'workouts' ? 'active' : ''}`}\n            onClick={() => setActiveTab('workouts')}\n          >\n            🏃‍♂️ Workouts\n          </button>\n          <button \n            className={`tab-button ${activeTab === 'events' ? 'active' : ''}`}\n            onClick={() => setActiveTab('events')}\n          >\n            🎉 Events\n          </button>\n        </div>\n\n        {/* Workouts Section */}\n        {activeTab === 'workouts' && (\n          <div className=\"workouts-section\">\n            <div className=\"section-header\">\n              <h2>Workout Posts</h2>\n              {isExec(currentUser) && (\n                <button \n                  className=\"new-post-btn\"\n                  onClick={() => setShowWorkoutForm(true)}\n                >\n                  + New Workout\n                </button>\n              )}\n            </div>\n\n            {/* Workout Filter Buttons */}\n            <div className=\"workout-filters\">\n              <button \n                className={`filter-btn ${workoutFilter === 'all' ? 'active' : ''}`}\n                onClick={() => setWorkoutFilter('all')}\n              >\n                🏃‍♂️ All Workouts\n              </button>\n              <button \n                className={`filter-btn ${workoutFilter === 'bike' ? 'active' : ''}`}\n                onClick={() => setWorkoutFilter('bike')}\n              >\n                🚴‍♂️ Bike (Indoor/Outdoor/Brick)\n              </button>\n              <button \n                className={`filter-btn ${workoutFilter === 'swim' ? 'active' : ''}`}\n                onClick={() => setWorkoutFilter('swim')}\n              >\n                🏊‍♂️ Swim\n              </button>\n              <button \n                className={`filter-btn ${workoutFilter === 'run' ? 'active' : ''}`}\n                onClick={() => setWorkoutFilter('run')}\n              >\n                🏃‍♀️ Run\n              </button>\n            </div>\n\n            {getFilteredWorkouts().length === 0 ? (\n              <p className=\"no-posts\">\n                {workoutPosts.length === 0 ? 'No workout posts yet.' : `No ${workoutFilter === 'all' ? '' : workoutFilter} workouts found.`}\n              </p>\n            ) : (\n              <div className=\"posts-list\">\n                {getFilteredWorkouts().map(post => (\n                  <div key={post.id} className=\"post-card workout-post\">\n                    <div className=\"post-header\">\n                      {post.title && (\n                        <div className=\"workout-title\">\n                          <h2>\n                            <a href={`/workout/${post.id}`} className=\"workout-title-link\">\n                              {post.title}\n                            </a>\n                          </h2>\n                        </div>\n                      )}\n                      \n                      {/* Delete button for workout author */}\n                      {currentUser.id === post.user_id && (\n                        <button \n                          className=\"delete-btn\"\n                          onClick={() => handleDeleteWorkout(post.id)}\n                        >\n                          🗑️ Delete\n                        </button>\n                      )}\n                    </div>\n                    \n                    <div className=\"workout-author\">\n                      <div className=\"author-info\">\n                        {post.authorProfilePictureUrl ? (\n                          <img \n                            src={`http://localhost:5001${post.authorProfilePictureUrl}`} \n                            alt=\"Profile\" \n                            className=\"author-avatar\"\n                          />\n                        ) : (\n                          <div className=\"author-avatar-placeholder\">\n                            <span>{post.author_name ? post.author_name.charAt(0).toUpperCase() : 'U'}</span>\n                          </div>\n                        )}\n                        <span className=\"author-name\">Posted by {post.author_name}</span>\n                      </div>\n                    </div>\n                    \n                    {post.workout_type && (\n                      <div className=\"workout-meta\">\n                        <span className=\"workout-type-badge\">{post.workout_type}</span>\n                        {post.workout_date && (\n                          <span className=\"workout-date\">\n                            📅 {new Date(post.workout_date).toLocaleDateString()}\n                            {post.workout_time && (\n                              <span className=\"workout-time\"> • 🕐 {post.workout_time}</span>\n                            )}\n                          </span>\n                        )}\n                      </div>\n                    )}\n\n                    {/* Sign-up button positioned at bottom right */}\n                    <div className=\"workout-signup-section\">\n                      <div className=\"button-group\">\n                        <button \n                          className={`signup-btn ${isUserSignedUp(post.id) ? 'signed-up' : ''} ${isWorkoutFull(post.id) ? 'full' : ''}`}\n                          onClick={() => handleWorkoutSignUp(post.id)}\n                          disabled={isWorkoutFull(post.id) && !isUserSignedUp(post.id)}\n                        >\n                          {isUserSignedUp(post.id) ? '✓ Signed Up' : isWorkoutFull(post.id) ? 'Full' : 'Sign Up'}\n                        </button>\n                        \n                        {/* Cancel button for signed-up users */}\n                        {isUserSignedUp(post.id) && (\n                          <button \n                            className=\"cancel-btn\"\n                            onClick={() => handleCancelClick(post.id)}\n                          >\n                            Cancel\n                          </button>\n                        )}\n                        \n                        {/* Waitlist button for full workouts */}\n                        {post.capacity && isWorkoutFull(post.id) && !isUserSignedUp(post.id) && (\n                          <button \n                            className={`waitlist-btn ${isUserOnWaitlist(post.id) ? 'on-waitlist' : ''}`}\n                            onClick={() => isUserOnWaitlist(post.id) ? handleWaitlistLeave(post.id) : handleWaitlistJoin(post.id)}\n                          >\n                            {isUserOnWaitlist(post.id) ? 'Leave Waitlist' : 'Join Waitlist'}\n                          </button>\n                        )}\n                        \n                        {/* Position label when on waitlist */}\n                        {post.capacity && isWorkoutFull(post.id) && isUserOnWaitlist(post.id) && (\n                          <span className=\"waitlist-position\">\n                            {`You're ${formatOrdinal(getWaitlistPosition(post.id))} on the waitlist`}\n                          </span>\n                        )}\n                      </div>\n                      \n                      <span className=\"signup-count\">\n                        {post.capacity \n                          ? `${workoutSignups[post.id]?.length || 0}/${post.capacity} signed up`\n                          : `${workoutSignups[post.id]?.length || 0} signed up`\n                        }\n                        {post.capacity && (\n                          <span className={`capacity-status ${isWorkoutFull(post.id) ? 'full' : 'available'}`}>\n                            {isWorkoutFull(post.id) ? ' (Full)' : ' (Available)'}\n                          </span>\n                        )}\n                        {post.capacity && workoutWaitlists[post.id]?.length > 0 && (\n                          <span className=\"waitlist-count\">\n                            • {workoutWaitlists[post.id].length} on waitlist\n                          </span>\n                        )}\n                      </span>\n                    </div>\n\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Events Section */}\n        {activeTab === 'events' && (\n          <div className=\"events-section\">\n            <div className=\"section-header\">\n              <h2>Event Posts</h2>\n              {isExec(currentUser) && (\n                <button \n                  className=\"new-post-btn\"\n                  onClick={() => setShowEventForm(true)}\n                >\n                  + New Event\n                </button>\n              )}\n            </div>\n\n            {eventPosts.length === 0 ? (\n              <p className=\"no-posts\">No event posts yet.</p>\n            ) : (\n              <div className=\"posts-list\">\n                {eventPosts.map(post => (\n                  <div key={post.id} className=\"post-card event-post\">\n                    <div className=\"post-header\">\n                      {post.title && (\n                        <div className=\"event-title\">\n                          <h3>\n                            <a href={`/event/${post.id}`} className=\"event-title-link\">\n                              {post.title}\n                            </a>\n                          </h3>\n                        </div>\n                      )}\n                      \n                      {/* Delete button for event author */}\n                      {currentUser.id === post.user_id && (\n                        <button \n                          className=\"delete-btn\"\n                          onClick={() => handleDeleteEvent(post.id)}\n                        >\n                          🗑️ Delete\n                        </button>\n                      )}\n                    </div>\n                    \n                    <div className=\"event-author\">\n                      <div className=\"author-info\">\n                        {post.authorProfilePictureUrl ? (\n                          <img \n                            src={`http://localhost:5001${post.authorProfilePictureUrl}`} \n                            alt=\"Profile\" \n                            className=\"author-avatar\"\n                          />\n                        ) : (\n                          <div className=\"author-avatar-placeholder\">\n                            <span>{post.author_name ? post.author_name.charAt(0).toUpperCase() : 'U'}</span>\n                          </div>\n                        )}\n                        <span className=\"author-name\">Posted by {post.author_name}</span>\n                      </div>\n                    </div>\n                    \n                    {post.event_date && (\n                      <div className=\"event-meta\">\n                        <span className=\"event-date\">\n                          📅 {new Date(post.event_date).toLocaleDateString()}\n                        </span>\n                      </div>\n                    )}\n                    \n                    <div className=\"post-footer\">\n                      <div className=\"rsvp-buttons\">\n                        <button className=\"rsvp-btn going\">Going</button>\n                        <button className=\"rsvp-btn maybe\">Maybe</button>\n                        <button className=\"rsvp-btn not-going\">Not Going</button>\n                      </div>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Waitlist Promotion Success Message */}\n        {showPromotionMessage && promotedWorkout && (\n          <div className=\"promotion-message\">\n            <div className=\"promotion-content\">\n              <h3>🎉 Congratulations!</h3>\n              <p>You've been promoted from the waitlist for <strong>{promotedWorkout.title}</strong>!</p>\n              <p>Check your email for details. You're now officially signed up for this workout.</p>\n              <button \n                className=\"promotion-close-btn\"\n                onClick={() => setShowPromotionMessage(false)}\n              >\n                ✕\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* Cancel Confirmation Modal */}\n        {showCancelModal && (\n          <div className=\"modal-overlay\">\n            <div className=\"modal cancel-modal\">\n              <h2>Cancel Workout Signup</h2>\n              <div className=\"cancel-warning\">\n                <p>⚠️ <strong>Important:</strong> If you cancel less than 24 hours in advance, it will count as an absence.</p>\n                <p>Your absences are recorded and once you have three, you will be suspended from signing up for a week.</p>\n                <p>This is to keep it fair for all members!</p>\n              </div>\n              <div className=\"modal-actions\">\n                <button className=\"btn-secondary\" onClick={handleCancelCancel}>\n                  Keep Booking\n                </button>\n                <button className=\"btn-danger\" onClick={handleCancelConfirm}>\n                  Cancel\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Workout Creation Modal */}\n        {showWorkoutForm && (\n          <div className=\"modal-overlay\">\n            <div className=\"modal\">\n              <h2>Create New Workout Post</h2>\n              <form onSubmit={handleSubmitWorkout}>\n                <div className=\"form-group\">\n                  <label>Workout Title:</label>\n                  <input\n                    type=\"text\"\n                    value={workoutForm.title}\n                    onChange={(e) => setWorkoutForm({...workoutForm, title: e.target.value})}\n                    placeholder=\"e.g., Tuesday Morning Swim, Weekend Long Run\"\n                    maxLength=\"100\"\n                    required\n                  />\n                </div>\n\n                <div className=\"form-group\">\n                  <label>Workout Type:</label>\n                  <select\n                    value={workoutForm.type}\n                    onChange={(e) => setWorkoutForm({...workoutForm, type: e.target.value})}\n                    required\n                  >\n                    <option value=\"spin\">Spin</option>\n                    <option value=\"outdoor-ride\">Outdoor Ride</option>\n                    <option value=\"run\">Run</option>\n                    <option value=\"swim\">Swim</option>\n                    <option value=\"brick\">Brick (Bike + Run)</option>\n                    <option value=\"other\">Other</option>\n                  </select>\n                </div>\n\n                <div className=\"form-group\">\n                  <label>Workout Date:</label>\n                  <input\n                    type=\"date\"\n                    value={workoutForm.date}\n                    onChange={(e) => setWorkoutForm({...workoutForm, date: e.target.value})}\n                    min={new Date().toISOString().split('T')[0]}\n                    required\n                  />\n                </div>\n\n                <div className=\"form-group\">\n                  <label>Workout Time:</label>\n                  <input\n                    type=\"time\"\n                    value={workoutForm.time}\n                    onChange={(e) => setWorkoutForm({...workoutForm, time: e.target.value})}\n                    required\n                  />\n                </div>\n\n                <div className=\"form-group\">\n                  <label>Additional Details:</label>\n                  <textarea\n                    value={workoutForm.content}\n                    onChange={(e) => setWorkoutForm({...workoutForm, content: e.target.value})}\n                    placeholder=\"Describe the workout, time, location, requirements, what to bring...\"\n                    rows=\"4\"\n                    maxLength=\"500\"\n                    required\n                  />\n                  <small className=\"char-count\">{workoutForm.content.length}/500</small>\n                </div>\n\n                <div className=\"form-group\">\n                  <label>Capacity (Optional):</label>\n                  <input\n                    type=\"number\"\n                    value={workoutForm.capacity}\n                    onChange={(e) => setWorkoutForm({...workoutForm, capacity: e.target.value})}\n                    placeholder=\"Leave empty for unlimited spots\"\n                    min=\"1\"\n                    max=\"100\"\n                  />\n                  <small>Maximum number of people who can sign up. Leave empty for unlimited spots.</small>\n                </div>\n\n                <div className=\"modal-actions\">\n                  <button type=\"submit\" className=\"btn btn-primary\">Post Workout</button>\n                  <button type=\"button\" className=\"btn btn-secondary\" onClick={() => setShowWorkoutForm(false)}>Cancel</button>\n                </div>\n              </form>\n            </div>\n          </div>\n        )}\n\n        {/* Event Creation Modal */}\n        {showEventForm && (\n          <div className=\"modal-overlay\">\n            <div className=\"modal\">\n              <h2>Create New Event Post</h2>\n              <form onSubmit={handleSubmitEvent}>\n                <div className=\"form-group\">\n                  <label>Event Title:</label>\n                  <input\n                    type=\"text\"\n                    value={eventForm.title}\n                    onChange={(e) => setEventForm({...eventForm, title: e.target.value})}\n                    placeholder=\"e.g., Club Social Night, Race Watch Party\"\n                    maxLength=\"100\"\n                    required\n                  />\n                </div>\n\n                                <div className=\"form-group\">\n                  <label>Event Date:</label>\n                  <input\n                    type=\"date\"\n                    value={eventForm.date}\n                    onChange={(e) => setEventForm({...eventForm, date: e.target.value})}\n                    min={new Date().toISOString().split('T')[0]}\n                    required\n                  />\n                </div>\n\n                <div className=\"form-group\">\n                  <label>Event Details:</label>\n                  <textarea\n                    value={eventForm.content}\n                    onChange={(e) => setEventForm({...eventForm, content: e.target.value})}\n                    placeholder=\"Describe the event, time, location, what to bring, RSVP details...\"\n                    rows=\"4\"\n                    maxLength=\"500\"\n                    required\n                  />\n                  <small className=\"char-count\">{eventForm.content.length}/500</small>\n                </div>\n\n                <div className=\"modal-actions\">\n                  <button type=\"submit\" className=\"btn btn-primary\">Post Event</button>\n                  <button type=\"button\" className=\"btn btn-secondary\" onClick={() => setShowEventForm(false)}>Cancel</button>\n                </div>\n              </form>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default Forum;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}